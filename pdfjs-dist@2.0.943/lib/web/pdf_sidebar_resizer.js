"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFSidebarResizer=void 0;var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),_ui_utils=require("./ui_utils");function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var SIDEBAR_WIDTH_VAR="--sidebar-width",SIDEBAR_MIN_WIDTH=200,SIDEBAR_RESIZING_CLASS="sidebarResizing",PDFSidebarResizer=function(){function e(t,i){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_ui_utils.NullL10n;_classCallCheck(this,e),this.enabled=!1,this.isRTL=!1,this.sidebarOpen=!1,this.doc=document.documentElement,this._width=null,this._outerContainerWidth=null,this._boundEvents=Object.create(null),this.outerContainer=t.outerContainer,this.resizer=t.resizer,this.eventBus=i,this.l10n=s,"undefined"!==typeof CSS&&"function"===typeof CSS.supports&&CSS.supports(SIDEBAR_WIDTH_VAR,"calc(-1 * "+SIDEBAR_MIN_WIDTH+"px)")?(this.enabled=!0,this.resizer.classList.remove("hidden"),this.l10n.getDirection().then((function(e){n.isRTL="rtl"===e})),this._addEventListeners()):console.warn("PDFSidebarResizer: The browser does not support resizing of the sidebar.")}return _createClass(e,[{key:"_updateWidth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.enabled)return!1;var t=Math.floor(this.outerContainerWidth/2);return e>t&&(e=t),e<SIDEBAR_MIN_WIDTH&&(e=SIDEBAR_MIN_WIDTH),e!==this._width&&(this._width=e,this.doc.style.setProperty(SIDEBAR_WIDTH_VAR,e+"px"),!0)}},{key:"_mouseMove",value:function(e){var t=e.clientX;this.isRTL&&(t=this.outerContainerWidth-t),this._updateWidth(t)}},{key:"_mouseUp",value:function(e){this.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS),this.eventBus.dispatch("resize",{source:this});var t=this._boundEvents;window.removeEventListener("mousemove",t.mouseMove),window.removeEventListener("mouseup",t.mouseUp)}},{key:"_addEventListeners",value:function(){var e=this;if(this.enabled){var t=this._boundEvents;t.mouseMove=this._mouseMove.bind(this),t.mouseUp=this._mouseUp.bind(this),this.resizer.addEventListener("mousedown",(function(i){0===i.button&&(e.outerContainer.classList.add(SIDEBAR_RESIZING_CLASS),window.addEventListener("mousemove",t.mouseMove),window.addEventListener("mouseup",t.mouseUp))})),this.eventBus.on("sidebarviewchanged",(function(t){e.sidebarOpen=!(!t||!t.view)})),this.eventBus.on("resize",(function(t){if(t&&t.source===window&&(e._outerContainerWidth=null,e._width))if(e.sidebarOpen){e.outerContainer.classList.add(SIDEBAR_RESIZING_CLASS);var i=e._updateWidth(e._width);Promise.resolve().then((function(){e.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS),i&&e.eventBus.dispatch("resize",{source:e})}))}else e._updateWidth(e._width)}))}}},{key:"outerContainerWidth",get:function(){return this._outerContainerWidth||(this._outerContainerWidth=this.outerContainer.clientWidth),this._outerContainerWidth}}]),e}();exports.PDFSidebarResizer=PDFSidebarResizer;