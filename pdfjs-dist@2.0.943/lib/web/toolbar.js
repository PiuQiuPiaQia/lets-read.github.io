"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toolbar=void 0;var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),_ui_utils=require("./ui_utils");function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PAGE_NUMBER_LOADING_INDICATOR="visiblePageIsLoading",SCALE_SELECT_CONTAINER_PADDING=8,SCALE_SELECT_PADDING=22,Toolbar=function(){function e(t,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_ui_utils.NullL10n;_classCallCheck(this,e),this.toolbar=t.container,this.eventBus=i,this.l10n=a,this.items=t,this._wasLocalized=!1,this.reset(),this._bindListeners()}return _createClass(e,[{key:"setPageNumber",value:function(e,t){this.pageNumber=e,this.pageLabel=t,this._updateUIState(!1)}},{key:"setPagesCount",value:function(e,t){this.pagesCount=e,this.hasPageLabels=t,this._updateUIState(!0)}},{key:"setPageScale",value:function(e,t){this.pageScaleValue=(e||t).toString(),this.pageScale=t,this._updateUIState(!1)}},{key:"reset",value:function(){this.pageNumber=0,this.pageLabel=null,this.hasPageLabels=!1,this.pagesCount=0,this.pageScaleValue=_ui_utils.DEFAULT_SCALE_VALUE,this.pageScale=_ui_utils.DEFAULT_SCALE,this._updateUIState(!0)}},{key:"_bindListeners",value:function(){var e=this,t=this.eventBus,i=this.items,a=this;i.previous.addEventListener("click",(function(){t.dispatch("previouspage",{source:a})})),i.next.addEventListener("click",(function(){t.dispatch("nextpage",{source:a})})),i.zoomIn.addEventListener("click",(function(){t.dispatch("zoomin",{source:a})})),i.zoomOut.addEventListener("click",(function(){t.dispatch("zoomout",{source:a})})),i.pageNumber.addEventListener("click",(function(){this.select()})),i.pageNumber.addEventListener("change",(function(){t.dispatch("pagenumberchanged",{source:a,value:this.value})})),i.scaleSelect.addEventListener("change",(function(){"custom"!==this.value&&t.dispatch("scalechanged",{source:a,value:this.value})})),i.presentationModeButton.addEventListener("click",(function(){t.dispatch("presentationmode",{source:a})})),i.openFile.addEventListener("click",(function(){t.dispatch("openfile",{source:a})})),i.print.addEventListener("click",(function(){t.dispatch("print",{source:a})})),i.download.addEventListener("click",(function(){t.dispatch("download",{source:a})})),i.scaleSelect.oncontextmenu=_ui_utils.noContextMenuHandler,t.on("localized",(function(){e._localized()}))}},{key:"_localized",value:function(){this._wasLocalized=!0,this._adjustScaleWidth(),this._updateUIState(!0)}},{key:"_updateUIState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._wasLocalized){var t=this.pageNumber,i=this.pagesCount,a=this.pageScaleValue,n=this.pageScale,s=this.items;e&&(this.hasPageLabels?s.pageNumber.type="text":(s.pageNumber.type="number",this.l10n.get("of_pages",{pagesCount:i},"of {{pagesCount}}").then((function(e){s.numPages.textContent=e}))),s.pageNumber.max=i),this.hasPageLabels?(s.pageNumber.value=this.pageLabel,this.l10n.get("page_of_pages",{pageNumber:t,pagesCount:i},"({{pageNumber}} of {{pagesCount}})").then((function(e){s.numPages.textContent=e}))):s.pageNumber.value=t,s.previous.disabled=t<=1,s.next.disabled=t>=i,s.zoomOut.disabled=n<=_ui_utils.MIN_SCALE,s.zoomIn.disabled=n>=_ui_utils.MAX_SCALE;var u=Math.round(1e4*n)/100;this.l10n.get("page_scale_percent",{scale:u},"{{scale}}%").then((function(e){for(var t=s.scaleSelect.options,i=!1,n=0,u=t.length;n<u;n++){var o=t[n];o.value===a?(o.selected=!0,i=!0):o.selected=!1}i||(s.customScaleOption.textContent=e,s.customScaleOption.selected=!0)}))}}},{key:"updateLoadingIndicatorState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.items.pageNumber;t.classList.toggle(PAGE_NUMBER_LOADING_INDICATOR,e)}},{key:"_adjustScaleWidth",value:function(){var e=this.items.scaleSelectContainer,t=this.items.scaleSelect;_ui_utils.animationStarted.then((function(){if(0===e.clientWidth&&e.setAttribute("style","display: inherit;"),e.clientWidth>0){t.setAttribute("style","min-width: inherit;");var i=t.clientWidth+SCALE_SELECT_CONTAINER_PADDING;t.setAttribute("style","min-width: "+(i+SCALE_SELECT_PADDING)+"px;"),e.setAttribute("style","min-width: "+i+"px; max-width: "+i+"px;")}}))}}]),e}();exports.Toolbar=Toolbar;