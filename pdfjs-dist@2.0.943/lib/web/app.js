"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFPrintServiceFactory=exports.DefaultExternalServices=exports.PDFViewerApplication=void 0;var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_slicedToArray=function(){function e(e,i){var t=[],n=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)if(t.push(a.value),i&&t.length===i)break}catch(p){r=!0,o=p}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw o}}return t}return function(i,t){if(Array.isArray(i))return i;if(Symbol.iterator in Object(i))return e(i,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_ui_utils=require("./ui_utils"),_pdf=require("../pdf"),_pdf_cursor_tools=require("./pdf_cursor_tools"),_pdf_rendering_queue=require("./pdf_rendering_queue"),_pdf_sidebar=require("./pdf_sidebar"),_app_options=require("./app_options"),_dom_events=require("./dom_events"),_overlay_manager=require("./overlay_manager"),_password_prompt=require("./password_prompt"),_pdf_attachment_viewer=require("./pdf_attachment_viewer"),_pdf_document_properties=require("./pdf_document_properties"),_pdf_find_bar=require("./pdf_find_bar"),_pdf_find_controller=require("./pdf_find_controller"),_pdf_history=require("./pdf_history"),_pdf_link_service=require("./pdf_link_service"),_pdf_outline_viewer=require("./pdf_outline_viewer"),_pdf_presentation_mode=require("./pdf_presentation_mode"),_pdf_sidebar_resizer=require("./pdf_sidebar_resizer"),_pdf_thumbnail_viewer=require("./pdf_thumbnail_viewer"),_pdf_viewer=require("./pdf_viewer"),_secondary_toolbar=require("./secondary_toolbar"),_toolbar=require("./toolbar"),_view_history=require("./view_history");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var i=e.apply(this,arguments);return new Promise((function(e,t){function n(r,o){try{var a=i[r](o),s=a.value}catch(p){return void t(p)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}return n("next")}))}}var DEFAULT_SCALE_DELTA=1.1,DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT=5e3,FORCE_PAGES_LOADED_TIMEOUT=1e4,DefaultExternalServices={updateFindControlState:function(e){},updateFindMatchesCount:function(e){},initPassiveLoading:function(e){},fallback:function(e,i){},reportTelemetry:function(e){},createDownloadManager:function(e){throw new Error("Not implemented: createDownloadManager")},createPreferences:function(){throw new Error("Not implemented: createPreferences")},createL10n:function(e){throw new Error("Not implemented: createL10n")},supportsIntegratedFind:!1,supportsDocumentFonts:!0,supportsDocumentColors:!0,supportedMouseWheelZoomModifierKeys:{ctrlKey:!0,metaKey:!0}},PDFViewerApplication={initialBookmark:document.location.hash.substring(1),initialized:!1,fellback:!1,appConfig:null,pdfDocument:null,pdfLoadingTask:null,printService:null,pdfViewer:null,pdfThumbnailViewer:null,pdfRenderingQueue:null,pdfPresentationMode:null,pdfDocumentProperties:null,pdfLinkService:null,pdfHistory:null,pdfSidebar:null,pdfSidebarResizer:null,pdfOutlineViewer:null,pdfAttachmentViewer:null,pdfCursorTools:null,store:null,downloadManager:null,overlayManager:null,preferences:null,toolbar:null,secondaryToolbar:null,eventBus:null,l10n:null,isInitialViewSet:!1,downloadComplete:!1,isViewerEmbedded:window.parent!==window,url:"",baseUrl:"",externalServices:DefaultExternalServices,_boundEvents:{},contentDispositionFilename:null,initialize:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(i){var t,n=this;return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.preferences=this.externalServices.createPreferences(),this.appConfig=i,e.next=4,this._readPreferences();case 4:return e.next=6,this._parseHashParameters();case 6:return e.next=8,this._initializeL10n();case 8:return this.isViewerEmbedded&&_app_options.AppOptions.get("externalLinkTarget")===_pdf.LinkTarget.NONE&&_app_options.AppOptions.set("externalLinkTarget",_pdf.LinkTarget.TOP),e.next=11,this._initializeViewerComponents();case 11:this.bindEvents(),this.bindWindowEvents(),t=i.appContainer||document.documentElement,this.l10n.translate(t).then((function(){n.eventBus.dispatch("localized",{source:n})})),this.initialized=!0;case 16:case"end":return e.stop()}}),e,this)})));function i(i){return e.apply(this,arguments)}return i}(),_readPreferences:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(){var i,t,n;return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={disableFontFace:!0,disableRange:!0,disableStream:!0,textLayerMode:_ui_utils.TextLayerMode.DISABLE},e.prev=1,e.next=4,this.preferences.getAll();case 4:t=e.sent,e.t0=_regenerator2.default.keys(t);case 6:if((e.t1=e.t0()).done){e.next=13;break}if(n=e.t1.value,!(n in i)||_app_options.AppOptions.get(n)!==i[n]){e.next=10;break}return e.abrupt("continue",6);case 10:_app_options.AppOptions.set(n,t[n]),e.next=6;break;case 13:e.next=17;break;case 15:e.prev=15,e.t2=e["catch"](1);case 17:case"end":return e.stop()}}),e,this,[[1,15]])})));function i(){return e.apply(this,arguments)}return i}(),_parseHashParameters:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(){var i,t,n,r,o;return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(_app_options.AppOptions.get("pdfBugEnabled")){e.next=2;break}return e.abrupt("return");case 2:if(i=[],t=document.location.hash.substring(1),n=(0,_ui_utils.parseQueryString)(t),"disableworker"in n&&"true"===n["disableworker"]&&i.push(loadFakeWorker()),"disablerange"in n&&_app_options.AppOptions.set("disableRange","true"===n["disablerange"]),"disablestream"in n&&_app_options.AppOptions.set("disableStream","true"===n["disablestream"]),"disableautofetch"in n&&_app_options.AppOptions.set("disableAutoFetch","true"===n["disableautofetch"]),"disablefontface"in n&&_app_options.AppOptions.set("disableFontFace","true"===n["disablefontface"]),"disablehistory"in n&&_app_options.AppOptions.set("disableHistory","true"===n["disablehistory"]),"webgl"in n&&_app_options.AppOptions.set("enableWebGL","true"===n["webgl"]),"useonlycsszoom"in n&&_app_options.AppOptions.set("useOnlyCssZoom","true"===n["useonlycsszoom"]),"verbosity"in n&&_app_options.AppOptions.set("verbosity",0|n["verbosity"]),!("textlayer"in n)){e.next=23;break}e.t0=n["textlayer"],e.next="off"===e.t0?18:"visible"===e.t0||"shadow"===e.t0||"hover"===e.t0?20:23;break;case 18:return _app_options.AppOptions.set("textLayerMode",_ui_utils.TextLayerMode.DISABLE),e.abrupt("break",23);case 20:return r=this.appConfig.viewerContainer,r.classList.add("textLayer-"+n["textlayer"]),e.abrupt("break",23);case 23:return"pdfbug"in n&&(_app_options.AppOptions.set("pdfBug",!0),o=n["pdfbug"].split(","),i.push(loadAndEnablePDFBug(o))),"locale"in n&&_app_options.AppOptions.set("locale",n["locale"]),e.abrupt("return",Promise.all(i).catch((function(e){console.error('_parseHashParameters: "'+e.message+'".')})));case 26:case"end":return e.stop()}}),e,this)})));function i(){return e.apply(this,arguments)}return i}(),_initializeL10n:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(){var i;return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.l10n=this.externalServices.createL10n({locale:_app_options.AppOptions.get("locale")}),e.next=3,this.l10n.getDirection();case 3:i=e.sent,document.getElementsByTagName("html")[0].dir=i;case 5:case"end":return e.stop()}}),e,this)})));function i(){return e.apply(this,arguments)}return i}(),_initializeViewerComponents:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(){var i,t,n,r,o,a,s,p,l,d,c;return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=this.appConfig,this.overlayManager=new _overlay_manager.OverlayManager,t=_app_options.AppOptions.get("eventBusDispatchToDOM"),n=i.eventBus||(0,_dom_events.getGlobalEventBus)(t),this.eventBus=n,r=new _pdf_rendering_queue.PDFRenderingQueue,r.onIdle=this.cleanup.bind(this),this.pdfRenderingQueue=r,o=new _pdf_link_service.PDFLinkService({eventBus:n,externalLinkTarget:_app_options.AppOptions.get("externalLinkTarget"),externalLinkRel:_app_options.AppOptions.get("externalLinkRel")}),this.pdfLinkService=o,a=this.externalServices.createDownloadManager({disableCreateObjectURL:_app_options.AppOptions.get("disableCreateObjectURL")}),this.downloadManager=a,s=new _pdf_find_controller.PDFFindController({linkService:o,eventBus:n}),this.findController=s,p=i.mainContainer,l=i.viewerContainer,this.pdfViewer=new _pdf_viewer.PDFViewer({container:p,viewer:l,eventBus:n,renderingQueue:r,linkService:o,downloadManager:a,findController:s,renderer:_app_options.AppOptions.get("renderer"),enableWebGL:_app_options.AppOptions.get("enableWebGL"),l10n:this.l10n,textLayerMode:_app_options.AppOptions.get("textLayerMode"),imageResourcesPath:_app_options.AppOptions.get("imageResourcesPath"),renderInteractiveForms:_app_options.AppOptions.get("renderInteractiveForms"),enablePrintAutoRotate:_app_options.AppOptions.get("enablePrintAutoRotate"),useOnlyCssZoom:_app_options.AppOptions.get("useOnlyCssZoom"),maxCanvasPixels:_app_options.AppOptions.get("maxCanvasPixels")}),r.setViewer(this.pdfViewer),o.setViewer(this.pdfViewer),d=i.sidebar.thumbnailView,this.pdfThumbnailViewer=new _pdf_thumbnail_viewer.PDFThumbnailViewer({container:d,renderingQueue:r,linkService:o,l10n:this.l10n}),r.setThumbnailViewer(this.pdfThumbnailViewer),this.pdfHistory=new _pdf_history.PDFHistory({linkService:o,eventBus:n}),o.setHistory(this.pdfHistory),this.findBar=new _pdf_find_bar.PDFFindBar(i.findBar,n,this.l10n),this.pdfDocumentProperties=new _pdf_document_properties.PDFDocumentProperties(i.documentProperties,this.overlayManager,n,this.l10n),this.pdfCursorTools=new _pdf_cursor_tools.PDFCursorTools({container:p,eventBus:n,cursorToolOnLoad:_app_options.AppOptions.get("cursorToolOnLoad")}),this.toolbar=new _toolbar.Toolbar(i.toolbar,n,this.l10n),this.secondaryToolbar=new _secondary_toolbar.SecondaryToolbar(i.secondaryToolbar,p,n),this.supportsFullscreen&&(this.pdfPresentationMode=new _pdf_presentation_mode.PDFPresentationMode({container:p,viewer:l,pdfViewer:this.pdfViewer,eventBus:n,contextMenuItems:i.fullscreen})),this.passwordPrompt=new _password_prompt.PasswordPrompt(i.passwordOverlay,this.overlayManager,this.l10n),this.pdfOutlineViewer=new _pdf_outline_viewer.PDFOutlineViewer({container:i.sidebar.outlineView,eventBus:n,linkService:o}),this.pdfAttachmentViewer=new _pdf_attachment_viewer.PDFAttachmentViewer({container:i.sidebar.attachmentsView,eventBus:n,downloadManager:a}),c=Object.create(i.sidebar),c.pdfViewer=this.pdfViewer,c.pdfThumbnailViewer=this.pdfThumbnailViewer,this.pdfSidebar=new _pdf_sidebar.PDFSidebar(c,n,this.l10n),this.pdfSidebar.onToggled=this.forceRendering.bind(this),this.pdfSidebarResizer=new _pdf_sidebar_resizer.PDFSidebarResizer(i.sidebarResizer,n,this.l10n);case 39:case"end":return e.stop()}}),e,this)})));function i(){return e.apply(this,arguments)}return i}(),run:function(e){this.initialize(e).then(webViewerInitialized)},zoomIn:function(e){var i=this.pdfViewer.currentScale;do{i=(i*DEFAULT_SCALE_DELTA).toFixed(2),i=Math.ceil(10*i)/10,i=Math.min(_ui_utils.MAX_SCALE,i)}while(--e>0&&i<_ui_utils.MAX_SCALE);this.pdfViewer.currentScaleValue=i},zoomOut:function(e){var i=this.pdfViewer.currentScale;do{i=(i/DEFAULT_SCALE_DELTA).toFixed(2),i=Math.floor(10*i)/10,i=Math.max(_ui_utils.MIN_SCALE,i)}while(--e>0&&i>_ui_utils.MIN_SCALE);this.pdfViewer.currentScaleValue=i},get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0},set page(e){this.pdfViewer.currentPageNumber=e},get page(){return this.pdfViewer.currentPageNumber},get printing(){return!!this.printService},get supportsPrinting(){return PDFPrintServiceFactory.instance.supportsPrinting},get supportsFullscreen(){var e=void 0,i=document.documentElement;return e=!!(i.requestFullscreen||i.mozRequestFullScreen||i.webkitRequestFullScreen||i.msRequestFullscreen),!1!==document.fullscreenEnabled&&!1!==document.mozFullScreenEnabled&&!1!==document.webkitFullscreenEnabled&&!1!==document.msFullscreenEnabled||(e=!1),(0,_pdf.shadow)(this,"supportsFullscreen",e)},get supportsIntegratedFind(){return this.externalServices.supportsIntegratedFind},get supportsDocumentFonts(){return this.externalServices.supportsDocumentFonts},get supportsDocumentColors(){return this.externalServices.supportsDocumentColors},get loadingBar(){var e=new _ui_utils.ProgressBar("#loadingBar");return(0,_pdf.shadow)(this,"loadingBar",e)},get supportedMouseWheelZoomModifierKeys(){return this.externalServices.supportedMouseWheelZoomModifierKeys},initPassiveLoading:function(){throw new Error("Not implemented: initPassiveLoading")},setTitleUsingUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.url=e,this.baseUrl=e.split("#")[0];var i=(0,_ui_utils.getPDFFileNameFromURL)(e,"");if(!i)try{i=decodeURIComponent((0,_pdf.getFilenameFromUrl)(e))||e}catch(t){i=e}this.setTitle(i)},setTitle:function(e){this.isViewerEmbedded||(document.title=e)},close:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(){var i,t;return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(i=this.appConfig.errorWrapper.container,i.setAttribute("hidden","true"),this.pdfLoadingTask){e.next=4;break}return e.abrupt("return");case 4:return t=this.pdfLoadingTask.destroy(),this.pdfLoadingTask=null,this.pdfDocument&&(this.pdfDocument=null,this.pdfThumbnailViewer.setDocument(null),this.pdfViewer.setDocument(null),this.pdfLinkService.setDocument(null),this.pdfDocumentProperties.setDocument(null)),this.store=null,this.isInitialViewSet=!1,this.downloadComplete=!1,this.url="",this.baseUrl="",this.contentDispositionFilename=null,this.pdfSidebar.reset(),this.pdfOutlineViewer.reset(),this.pdfAttachmentViewer.reset(),this.findBar.reset(),this.toolbar.reset(),this.secondaryToolbar.reset(),"undefined"!==typeof PDFBug&&PDFBug.cleanup(),e.abrupt("return",t);case 21:case"end":return e.stop()}}),e,this)})));function i(){return e.apply(this,arguments)}return i}(),open:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(i,t){var n,r,o,a,s,p,l,d=this;return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.pdfLoadingTask){e.next=3;break}return e.next=3,this.close();case 3:for(r in n=_app_options.AppOptions.getAll("worker"),n)_pdf.GlobalWorkerOptions[r]=n[r];for(s in o=Object.create(null),"string"===typeof i?(this.setTitleUsingUrl(i),o.url=i):i&&"byteLength"in i?o.data=i:i.url&&i.originalUrl&&(this.setTitleUsingUrl(i.originalUrl),o.url=i.url),a=_app_options.AppOptions.getAll("api"),a)o[s]=a[s];if(t)for(p in t)"length"===p&&this.pdfDocumentProperties.setFileSize(t[p]),o[p]=t[p];return l=(0,_pdf.getDocument)(o),this.pdfLoadingTask=l,l.onPassword=function(e,i){d.passwordPrompt.setUpdateCallback(e,i),d.passwordPrompt.open()},l.onProgress=function(e){var i=e.loaded,t=e.total;d.progress(i/t)},l.onUnsupportedFeature=this.fallback.bind(this),e.abrupt("return",l.promise.then((function(e){d.load(e)}),(function(e){if(l===d.pdfLoadingTask){var i=e&&e.message,t=void 0;return t=e instanceof _pdf.InvalidPDFException?d.l10n.get("invalid_file_error",null,"Invalid or corrupted PDF file."):e instanceof _pdf.MissingPDFException?d.l10n.get("missing_file_error",null,"Missing PDF file."):e instanceof _pdf.UnexpectedResponseException?d.l10n.get("unexpected_response_error",null,"Unexpected server response."):d.l10n.get("loading_error",null,"An error occurred while loading the PDF."),t.then((function(e){throw d.error(e,{message:i}),new Error(e)}))}})));case 16:case"end":return e.stop()}}),e,this)})));function i(i,t){return e.apply(this,arguments)}return i}(),download:function(){var e=this;function i(){r.downloadUrl(t,n)}var t=this.baseUrl,n=this.contentDispositionFilename||(0,_ui_utils.getPDFFileNameFromURL)(this.url),r=this.downloadManager;r.onerror=function(i){e.error("PDF failed to download: "+i)},this.pdfDocument&&this.downloadComplete?this.pdfDocument.getData().then((function(e){var i=new Blob([e],{type:"application/pdf"});r.download(i,t,n)})).catch(i):i()},fallback:function(e){},error:function(e,i){var t=[this.l10n.get("error_version_info",{version:_pdf.version||"?",build:_pdf.build||"?"},"PDF.js v{{version}} (build: {{build}})")];i&&(t.push(this.l10n.get("error_message",{message:i.message},"Message: {{message}}")),i.stack?t.push(this.l10n.get("error_stack",{stack:i.stack},"Stack: {{stack}}")):(i.filename&&t.push(this.l10n.get("error_file",{file:i.filename},"File: {{file}}")),i.lineNumber&&t.push(this.l10n.get("error_line",{line:i.lineNumber},"Line: {{line}}"))));var n=this.appConfig.errorWrapper,r=n.container;r.removeAttribute("hidden");var o=n.errorMessage;o.textContent=e;var a=n.closeButton;a.onclick=function(){r.setAttribute("hidden","true")};var s=n.errorMoreInfo,p=n.moreInfoButton,l=n.lessInfoButton;p.onclick=function(){s.removeAttribute("hidden"),p.setAttribute("hidden","true"),l.removeAttribute("hidden"),s.style.height=s.scrollHeight+"px"},l.onclick=function(){s.setAttribute("hidden","true"),p.removeAttribute("hidden"),l.setAttribute("hidden","true")},p.oncontextmenu=_ui_utils.noContextMenuHandler,l.oncontextmenu=_ui_utils.noContextMenuHandler,a.oncontextmenu=_ui_utils.noContextMenuHandler,p.removeAttribute("hidden"),l.setAttribute("hidden","true"),Promise.all(t).then((function(e){s.value=e.join("\n")}))},progress:function(e){var i=this;if(!this.downloadComplete){var t=Math.round(100*e);if(t>this.loadingBar.percent||isNaN(t)){this.loadingBar.percent=t;var n=this.pdfDocument?this.pdfDocument.loadingParams["disableAutoFetch"]:_app_options.AppOptions.get("disableAutoFetch");n&&t&&(this.disableAutoFetchLoadingBarTimeout&&(clearTimeout(this.disableAutoFetchLoadingBarTimeout),this.disableAutoFetchLoadingBarTimeout=null),this.loadingBar.show(),this.disableAutoFetchLoadingBarTimeout=setTimeout((function(){i.loadingBar.hide(),i.disableAutoFetchLoadingBarTimeout=null}),DISABLE_AUTO_FETCH_LOADING_BAR_TIMEOUT))}}},load:function(e){var i=this;this.pdfDocument=e,e.getDownloadInfo().then((function(){i.downloadComplete=!0,i.loadingBar.hide(),a.then((function(){i.eventBus.dispatch("documentloaded",{source:i}),i.eventBus.dispatch("documentload",{source:i})}))}));var t=e.getPageMode().catch((function(){}));this.toolbar.setPagesCount(e.numPages,!1),this.secondaryToolbar.setPagesCount(e.numPages);var n=this.store=new _view_history.ViewHistory(e.fingerprint),r=void 0;r=null,this.pdfLinkService.setDocument(e,r),this.pdfDocumentProperties.setDocument(e,this.url);var o=this.pdfViewer;o.setDocument(e);var a=o.firstPagePromise,s=o.pagesPromise,p=o.onePageRendered,l=this.pdfThumbnailViewer;l.setDocument(e),a.then((function(r){if(i.loadingBar.setWidth(i.appConfig.viewerContainer),!_app_options.AppOptions.get("disableHistory")&&!i.isViewerEmbedded){var a=!_app_options.AppOptions.get("showPreviousViewOnLoad");i.pdfHistory.initialize(e.fingerprint,a),i.pdfHistory.initialBookmark&&(i.initialBookmark=i.pdfHistory.initialBookmark,i.initialRotation=i.pdfHistory.initialRotation)}var p=n.getMultiple({page:null,zoom:_ui_utils.DEFAULT_SCALE_VALUE,scrollLeft:"0",scrollTop:"0",rotation:null,sidebarView:_pdf_sidebar.SidebarView.NONE,scrollMode:null,spreadMode:null}).catch((function(){}));Promise.all([p,t]).then(function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(t){var n,r,a,p,l,d,c,u=_slicedToArray(t,2),w=u[0],f=void 0===w?{}:w,h=u[1];return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=i.initialBookmark,r=_app_options.AppOptions.get("defaultZoomValue"),a=r?"zoom="+r:null,p=null,l=_app_options.AppOptions.get("sidebarViewOnLoad"),d=_app_options.AppOptions.get("scrollModeOnLoad"),c=_app_options.AppOptions.get("spreadModeOnLoad"),f.page&&_app_options.AppOptions.get("showPreviousViewOnLoad")&&(a="page="+f.page+"&zoom="+(r||f.zoom)+","+f.scrollLeft+","+f.scrollTop,p=parseInt(f.rotation,10),l=l||0|f.sidebarView,d=d||0|f.scrollMode,c=c||0|f.spreadMode),h&&!_app_options.AppOptions.get("disablePageMode")&&(l=l||apiPageModeToSidebarView(h)),i.setInitialView(a,{rotation:p,sidebarView:l,scrollMode:d,spreadMode:c}),i.eventBus.dispatch("documentinit",{source:i}),i.isViewerEmbedded||o.focus(),e.next=14,Promise.race([s,new Promise((function(e){setTimeout(e,FORCE_PAGES_LOADED_TIMEOUT)}))]);case 14:if(n||a){e.next=16;break}return e.abrupt("return");case 16:if(!o.hasEqualPageSizes){e.next=18;break}return e.abrupt("return");case 18:i.initialBookmark=n,o.currentScaleValue=o.currentScaleValue,i.setInitialView(a);case 21:case"end":return e.stop()}}),e,i)})));return function(i){return e.apply(this,arguments)}}()).then((function(){o.update()}))})),e.getPageLabels().then((function(t){if(t&&!_app_options.AppOptions.get("disablePageLabels")){var n=0,r=t.length;if(r===i.pagesCount){while(n<r&&t[n]===(n+1).toString())n++;n!==r&&(o.setPageLabels(t),l.setPageLabels(t),i.toolbar.setPagesCount(e.numPages,!0),i.toolbar.setPageNumber(o.currentPageNumber,o.currentPageLabel))}else console.error("The number of Page Labels does not match the number of pages in the document.")}})),s.then((function(){i.supportsPrinting&&e.getJavaScript().then((function(e){if(e){e.some((function(e){return!!e&&(console.warn("Warning: JavaScript is not supported"),i.fallback(_pdf.UNSUPPORTED_FEATURES.javaScript),!0)}));for(var t=/\bprint\s*\(/,n=0,r=e.length;n<r;n++){var o=e[n];if(o&&t.test(o))return void setTimeout((function(){window.print()}))}}}))})),Promise.all([p,_ui_utils.animationStarted]).then((function(){e.getOutline().then((function(e){i.pdfOutlineViewer.render({outline:e})})),e.getAttachments().then((function(e){i.pdfAttachmentViewer.render({attachments:e})}))})),e.getMetadata().then((function(t){var n=t.info,r=t.metadata,o=t.contentDispositionFilename;i.documentInfo=n,i.metadata=r,i.contentDispositionFilename=o,console.log("PDF "+e.fingerprint+" ["+n.PDFFormatVersion+" "+(n.Producer||"-").trim()+" / "+(n.Creator||"-").trim()+"] (PDF.js: "+(_pdf.version||"-")+(_app_options.AppOptions.get("enableWebGL")?" [WebGL]":"")+")");var a=void 0;if(r&&r.has("dc:title")){var s=r.get("dc:title");"Untitled"!==s&&(a=s)}!a&&n&&n["Title"]&&(a=n["Title"]),a?i.setTitle(a+" - "+(o||document.title)):o&&i.setTitle(o),n.IsAcroFormPresent&&(console.warn("Warning: AcroForm/XFA is not supported"),i.fallback(_pdf.UNSUPPORTED_FEATURES.forms))}))},setInitialView:function(e){var i=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.rotation,r=t.sidebarView,o=t.scrollMode,a=t.spreadMode,s=function(e){(0,_ui_utils.isValidRotation)(e)&&(i.pdfViewer.pagesRotation=e)},p=function(e,t){Number.isInteger(e)&&(i.pdfViewer.scrollMode=e),Number.isInteger(t)&&(i.pdfViewer.spreadMode=t)};p(o,a),this.isInitialViewSet=!0,this.pdfSidebar.setInitialView(r),this.initialBookmark?(s(this.initialRotation),delete this.initialRotation,this.pdfLinkService.setHash(this.initialBookmark),this.initialBookmark=null):e&&(s(n),this.pdfLinkService.setHash(e)),this.toolbar.setPageNumber(this.pdfViewer.currentPageNumber,this.pdfViewer.currentPageLabel),this.secondaryToolbar.setPageNumber(this.pdfViewer.currentPageNumber),this.pdfViewer.currentScaleValue||(this.pdfViewer.currentScaleValue=_ui_utils.DEFAULT_SCALE_VALUE)},cleanup:function(){this.pdfDocument&&(this.pdfViewer.cleanup(),this.pdfThumbnailViewer.cleanup(),this.pdfViewer.renderer!==_ui_utils.RendererType.SVG&&this.pdfDocument.cleanup())},forceRendering:function(){this.pdfRenderingQueue.printing=this.printing,this.pdfRenderingQueue.isThumbnailViewEnabled=this.pdfSidebar.isThumbnailViewVisible,this.pdfRenderingQueue.renderHighestPriority()},beforePrint:function(){var e=this;if(!this.printService)if(this.supportsPrinting)if(this.pdfViewer.pageViewsReady){var i=this.pdfViewer.getPagesOverview(),t=this.appConfig.printContainer,n=PDFPrintServiceFactory.instance.createPrintService(this.pdfDocument,i,t,this.l10n);this.printService=n,this.forceRendering(),n.layout()}else this.l10n.get("printing_not_ready",null,"Warning: The PDF is not fully loaded for printing.").then((function(e){window.alert(e)}));else this.l10n.get("printing_not_supported",null,"Warning: Printing is not fully supported by this browser.").then((function(i){e.error(i)}))},afterPrint:function(){this.printService&&(this.printService.destroy(),this.printService=null),this.forceRendering()},rotatePages:function(e){if(this.pdfDocument){var i=(this.pdfViewer.pagesRotation+360+e)%360;this.pdfViewer.pagesRotation=i}},requestPresentationMode:function(){this.pdfPresentationMode&&this.pdfPresentationMode.request()},bindEvents:function(){var e=this.eventBus,i=this._boundEvents;i.beforePrint=this.beforePrint.bind(this),i.afterPrint=this.afterPrint.bind(this),e.on("resize",webViewerResize),e.on("hashchange",webViewerHashchange),e.on("beforeprint",i.beforePrint),e.on("afterprint",i.afterPrint),e.on("pagerendered",webViewerPageRendered),e.on("textlayerrendered",webViewerTextLayerRendered),e.on("updateviewarea",webViewerUpdateViewarea),e.on("pagechanging",webViewerPageChanging),e.on("scalechanging",webViewerScaleChanging),e.on("rotationchanging",webViewerRotationChanging),e.on("sidebarviewchanged",webViewerSidebarViewChanged),e.on("pagemode",webViewerPageMode),e.on("namedaction",webViewerNamedAction),e.on("presentationmodechanged",webViewerPresentationModeChanged),e.on("presentationmode",webViewerPresentationMode),e.on("openfile",webViewerOpenFile),e.on("print",webViewerPrint),e.on("download",webViewerDownload),e.on("firstpage",webViewerFirstPage),e.on("lastpage",webViewerLastPage),e.on("nextpage",webViewerNextPage),e.on("previouspage",webViewerPreviousPage),e.on("zoomin",webViewerZoomIn),e.on("zoomout",webViewerZoomOut),e.on("pagenumberchanged",webViewerPageNumberChanged),e.on("scalechanged",webViewerScaleChanged),e.on("rotatecw",webViewerRotateCw),e.on("rotateccw",webViewerRotateCcw),e.on("switchscrollmode",webViewerSwitchScrollMode),e.on("scrollmodechanged",webViewerScrollModeChanged),e.on("switchspreadmode",webViewerSwitchSpreadMode),e.on("spreadmodechanged",webViewerSpreadModeChanged),e.on("documentproperties",webViewerDocumentProperties),e.on("find",webViewerFind),e.on("findfromurlhash",webViewerFindFromUrlHash),e.on("updatefindmatchescount",webViewerUpdateFindMatchesCount),e.on("updatefindcontrolstate",webViewerUpdateFindControlState),e.on("fileinputchange",webViewerFileInputChange)},bindWindowEvents:function(){var e=this.eventBus,i=this._boundEvents;i.windowResize=function(){e.dispatch("resize",{source:window})},i.windowHashChange=function(){e.dispatch("hashchange",{source:window,hash:document.location.hash.substring(1)})},i.windowBeforePrint=function(){e.dispatch("beforeprint",{source:window})},i.windowAfterPrint=function(){e.dispatch("afterprint",{source:window})},window.addEventListener("wheel",webViewerWheel),window.addEventListener("click",webViewerClick),window.addEventListener("keydown",webViewerKeyDown),window.addEventListener("resize",i.windowResize),window.addEventListener("hashchange",i.windowHashChange),window.addEventListener("beforeprint",i.windowBeforePrint),window.addEventListener("afterprint",i.windowAfterPrint)},unbindEvents:function(){var e=this.eventBus,i=this._boundEvents;e.off("resize",webViewerResize),e.off("hashchange",webViewerHashchange),e.off("beforeprint",i.beforePrint),e.off("afterprint",i.afterPrint),e.off("pagerendered",webViewerPageRendered),e.off("textlayerrendered",webViewerTextLayerRendered),e.off("updateviewarea",webViewerUpdateViewarea),e.off("pagechanging",webViewerPageChanging),e.off("scalechanging",webViewerScaleChanging),e.off("rotationchanging",webViewerRotationChanging),e.off("sidebarviewchanged",webViewerSidebarViewChanged),e.off("pagemode",webViewerPageMode),e.off("namedaction",webViewerNamedAction),e.off("presentationmodechanged",webViewerPresentationModeChanged),e.off("presentationmode",webViewerPresentationMode),e.off("openfile",webViewerOpenFile),e.off("print",webViewerPrint),e.off("download",webViewerDownload),e.off("firstpage",webViewerFirstPage),e.off("lastpage",webViewerLastPage),e.off("nextpage",webViewerNextPage),e.off("previouspage",webViewerPreviousPage),e.off("zoomin",webViewerZoomIn),e.off("zoomout",webViewerZoomOut),e.off("pagenumberchanged",webViewerPageNumberChanged),e.off("scalechanged",webViewerScaleChanged),e.off("rotatecw",webViewerRotateCw),e.off("rotateccw",webViewerRotateCcw),e.off("switchscrollmode",webViewerSwitchScrollMode),e.off("scrollmodechanged",webViewerScrollModeChanged),e.off("switchspreadmode",webViewerSwitchSpreadMode),e.off("spreadmodechanged",webViewerSpreadModeChanged),e.off("documentproperties",webViewerDocumentProperties),e.off("find",webViewerFind),e.off("findfromurlhash",webViewerFindFromUrlHash),e.off("updatefindmatchescount",webViewerUpdateFindMatchesCount),e.off("updatefindcontrolstate",webViewerUpdateFindControlState),e.off("fileinputchange",webViewerFileInputChange),i.beforePrint=null,i.afterPrint=null},unbindWindowEvents:function(){var e=this._boundEvents;window.removeEventListener("wheel",webViewerWheel),window.removeEventListener("click",webViewerClick),window.removeEventListener("keydown",webViewerKeyDown),window.removeEventListener("resize",e.windowResize),window.removeEventListener("hashchange",e.windowHashChange),window.removeEventListener("beforeprint",e.windowBeforePrint),window.removeEventListener("afterprint",e.windowAfterPrint),e.windowResize=null,e.windowHashChange=null,e.windowBeforePrint=null,e.windowAfterPrint=null}},validateFileURL=void 0,HOSTED_VIEWER_ORIGINS=["null","http://mozilla.github.io","https://mozilla.github.io"];function loadFakeWorker(){return _pdf.GlobalWorkerOptions.workerSrc||(_pdf.GlobalWorkerOptions.workerSrc=_app_options.AppOptions.get("workerSrc")),(0,_pdf.loadScript)(_pdf.PDFWorker.getWorkerSrc())}function loadAndEnablePDFBug(e){var i=PDFViewerApplication.appConfig;return(0,_pdf.loadScript)(i.debuggerScriptPath).then((function(){PDFBug.enable(e),PDFBug.init({OPS:_pdf.OPS,createObjectURL:_pdf.createObjectURL},i.mainContainer)}))}function webViewerInitialized(){var e=PDFViewerApplication.appConfig,i=void 0,t=document.location.search.substring(1),n=(0,_ui_utils.parseQueryString)(t);i="file"in n?n.file:_app_options.AppOptions.get("defaultUrl"),validateFileURL(i);var r=document.createElement("input");r.id=e.openFileInputName,r.className="fileInput",r.setAttribute("type","file"),r.oncontextmenu=_ui_utils.noContextMenuHandler,document.body.appendChild(r),window.File&&window.FileReader&&window.FileList&&window.Blob?r.value=null:(e.toolbar.openFile.setAttribute("hidden","true"),e.secondaryToolbar.openFileButton.setAttribute("hidden","true")),r.addEventListener("change",(function(e){var i=e.target.files;i&&0!==i.length&&PDFViewerApplication.eventBus.dispatch("fileinputchange",{source:this,fileInput:e.target})})),e.mainContainer.addEventListener("dragover",(function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"})),e.mainContainer.addEventListener("drop",(function(e){e.preventDefault();var i=e.dataTransfer.files;i&&0!==i.length&&PDFViewerApplication.eventBus.dispatch("fileinputchange",{source:this,fileInput:e.dataTransfer})})),PDFViewerApplication.supportsPrinting||(e.toolbar.print.classList.add("hidden"),e.secondaryToolbar.printButton.classList.add("hidden")),PDFViewerApplication.supportsFullscreen||(e.toolbar.presentationModeButton.classList.add("hidden"),e.secondaryToolbar.presentationModeButton.classList.add("hidden")),PDFViewerApplication.supportsIntegratedFind&&e.toolbar.viewFind.classList.add("hidden"),e.mainContainer.addEventListener("transitionend",(function(e){e.target===this&&PDFViewerApplication.eventBus.dispatch("resize",{source:this})}),!0),e.sidebar.toggleButton.addEventListener("click",(function(){PDFViewerApplication.pdfSidebar.toggle()}));try{webViewerOpenFileViaURL(i)}catch(o){PDFViewerApplication.l10n.get("loading_error",null,"An error occurred while loading the PDF.").then((function(e){PDFViewerApplication.error(e,o)}))}}validateFileURL=function(e){if(void 0!==e)try{var i=new _pdf.URL(window.location.href).origin||"null";if(HOSTED_VIEWER_ORIGINS.includes(i))return;var t=new _pdf.URL(e,window.location.href),n=t.origin,r=t.protocol;if(n!==i&&"blob:"!==r)throw new Error("file origin does not match viewer's")}catch(a){var o=a&&a.message;throw PDFViewerApplication.l10n.get("loading_error",null,"An error occurred while loading the PDF.").then((function(e){PDFViewerApplication.error(e,{message:o})})),a}};var webViewerOpenFileViaURL=void 0;function webViewerPageRendered(e){var i=e.pageNumber,t=i-1,n=PDFViewerApplication.pdfViewer.getPageView(t);if(i===PDFViewerApplication.page&&PDFViewerApplication.toolbar.updateLoadingIndicatorState(!1),n){if(PDFViewerApplication.pdfSidebar.isThumbnailViewVisible){var r=PDFViewerApplication.pdfThumbnailViewer.getThumbnail(t);r.setImage(n)}"undefined"!==typeof Stats&&Stats.enabled&&n.stats&&Stats.add(i,n.stats),n.error&&PDFViewerApplication.l10n.get("rendering_error",null,"An error occurred while rendering the page.").then((function(e){PDFViewerApplication.error(e,n.error)}))}}function webViewerTextLayerRendered(e){}function webViewerPageMode(e){var i=e.mode,t=void 0;switch(i){case"thumbs":t=_pdf_sidebar.SidebarView.THUMBS;break;case"bookmarks":case"outline":t=_pdf_sidebar.SidebarView.OUTLINE;break;case"attachments":t=_pdf_sidebar.SidebarView.ATTACHMENTS;break;case"none":t=_pdf_sidebar.SidebarView.NONE;break;default:return void console.error('Invalid "pagemode" hash parameter: '+i)}PDFViewerApplication.pdfSidebar.switchView(t,!0)}function webViewerNamedAction(e){var i=e.action;switch(i){case"GoToPage":PDFViewerApplication.appConfig.toolbar.pageNumber.select();break;case"Find":PDFViewerApplication.supportsIntegratedFind||PDFViewerApplication.findBar.toggle();break}}function webViewerPresentationModeChanged(e){var i=e.active,t=e.switchInProgress;PDFViewerApplication.pdfViewer.presentationModeState=t?_ui_utils.PresentationModeState.CHANGING:i?_ui_utils.PresentationModeState.FULLSCREEN:_ui_utils.PresentationModeState.NORMAL}function webViewerSidebarViewChanged(e){PDFViewerApplication.pdfRenderingQueue.isThumbnailViewEnabled=PDFViewerApplication.pdfSidebar.isThumbnailViewVisible;var i=PDFViewerApplication.store;i&&PDFViewerApplication.isInitialViewSet&&i.set("sidebarView",e.view).catch((function(){}))}function webViewerUpdateViewarea(e){var i=e.location,t=PDFViewerApplication.store;t&&PDFViewerApplication.isInitialViewSet&&t.setMultiple({page:i.pageNumber,zoom:i.scale,scrollLeft:i.left,scrollTop:i.top,rotation:i.rotation}).catch((function(){}));var n=PDFViewerApplication.pdfLinkService.getAnchorUrl(i.pdfOpenParams);PDFViewerApplication.appConfig.toolbar.viewBookmark.href=n,PDFViewerApplication.appConfig.secondaryToolbar.viewBookmarkButton.href=n;var r=PDFViewerApplication.pdfViewer.getPageView(PDFViewerApplication.page-1),o=r.renderingState!==_pdf_rendering_queue.RenderingStates.FINISHED;PDFViewerApplication.toolbar.updateLoadingIndicatorState(o)}function webViewerScrollModeChanged(e){var i=PDFViewerApplication.store;i&&PDFViewerApplication.isInitialViewSet&&i.set("scrollMode",e.mode).catch((function(){}))}function webViewerSpreadModeChanged(e){var i=PDFViewerApplication.store;i&&PDFViewerApplication.isInitialViewSet&&i.set("spreadMode",e.mode).catch((function(){}))}function webViewerResize(){var e=PDFViewerApplication.pdfDocument,i=PDFViewerApplication.pdfViewer;if(e){var t=i.currentScaleValue;"auto"!==t&&"page-fit"!==t&&"page-width"!==t||(i.currentScaleValue=t),i.update()}}function webViewerHashchange(e){var i=e.hash;i&&(PDFViewerApplication.isInitialViewSet?PDFViewerApplication.pdfHistory.popStateInProgress||PDFViewerApplication.pdfLinkService.setHash(i):PDFViewerApplication.initialBookmark=i)}webViewerOpenFileViaURL=function(e){if(e&&0===e.lastIndexOf("file:",0)){PDFViewerApplication.setTitleUsingUrl(e);var i=new XMLHttpRequest;i.onload=function(){PDFViewerApplication.open(new Uint8Array(i.response))};try{i.open("GET",e),i.responseType="arraybuffer",i.send()}catch(t){throw t}}else e&&PDFViewerApplication.open(e)};var webViewerFileInputChange=void 0;function webViewerPresentationMode(){PDFViewerApplication.requestPresentationMode()}function webViewerOpenFile(){var e=PDFViewerApplication.appConfig.openFileInputName;document.getElementById(e).click()}function webViewerPrint(){window.print()}function webViewerDownload(){PDFViewerApplication.download()}function webViewerFirstPage(){PDFViewerApplication.pdfDocument&&(PDFViewerApplication.page=1)}function webViewerLastPage(){PDFViewerApplication.pdfDocument&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount)}function webViewerNextPage(){PDFViewerApplication.page++}function webViewerPreviousPage(){PDFViewerApplication.page--}function webViewerZoomIn(){PDFViewerApplication.zoomIn()}function webViewerZoomOut(){PDFViewerApplication.zoomOut()}function webViewerPageNumberChanged(e){var i=PDFViewerApplication.pdfViewer;i.currentPageLabel=e.value,e.value!==i.currentPageNumber.toString()&&e.value!==i.currentPageLabel&&PDFViewerApplication.toolbar.setPageNumber(i.currentPageNumber,i.currentPageLabel)}function webViewerScaleChanged(e){PDFViewerApplication.pdfViewer.currentScaleValue=e.value}function webViewerRotateCw(){PDFViewerApplication.rotatePages(90)}function webViewerRotateCcw(){PDFViewerApplication.rotatePages(-90)}function webViewerSwitchScrollMode(e){PDFViewerApplication.pdfViewer.scrollMode=e.mode}function webViewerSwitchSpreadMode(e){PDFViewerApplication.pdfViewer.spreadMode=e.mode}function webViewerDocumentProperties(){PDFViewerApplication.pdfDocumentProperties.open()}function webViewerFind(e){PDFViewerApplication.findController.executeCommand("find"+e.type,{query:e.query,phraseSearch:e.phraseSearch,caseSensitive:e.caseSensitive,entireWord:e.entireWord,highlightAll:e.highlightAll,findPrevious:e.findPrevious})}function webViewerFindFromUrlHash(e){PDFViewerApplication.findController.executeCommand("find",{query:e.query,phraseSearch:e.phraseSearch,caseSensitive:!1,entireWord:!1,highlightAll:!0,findPrevious:!1})}function webViewerUpdateFindMatchesCount(e){var i=e.matchesCount;PDFViewerApplication.supportsIntegratedFind?PDFViewerApplication.externalServices.updateFindMatchesCount(i):PDFViewerApplication.findBar.updateResultsCount(i)}function webViewerUpdateFindControlState(e){var i=e.state,t=e.previous,n=e.matchesCount;PDFViewerApplication.supportsIntegratedFind?PDFViewerApplication.externalServices.updateFindControlState({result:i,findPrevious:t,matchesCount:n}):PDFViewerApplication.findBar.updateUIState(i,t,n)}function webViewerScaleChanging(e){PDFViewerApplication.toolbar.setPageScale(e.presetValue,e.scale),PDFViewerApplication.pdfViewer.update()}function webViewerRotationChanging(e){PDFViewerApplication.pdfThumbnailViewer.pagesRotation=e.pagesRotation,PDFViewerApplication.forceRendering(),PDFViewerApplication.pdfViewer.currentPageNumber=e.pageNumber}function webViewerPageChanging(e){var i=e.pageNumber;if(PDFViewerApplication.toolbar.setPageNumber(i,e.pageLabel||null),PDFViewerApplication.secondaryToolbar.setPageNumber(i),PDFViewerApplication.pdfSidebar.isThumbnailViewVisible&&PDFViewerApplication.pdfThumbnailViewer.scrollThumbnailIntoView(i),"undefined"!==typeof Stats&&Stats.enabled){var t=PDFViewerApplication.pdfViewer.getPageView(i-1);t&&t.stats&&Stats.add(i,t.stats)}}webViewerFileInputChange=function(e){if(!PDFViewerApplication.pdfViewer||!PDFViewerApplication.pdfViewer.isInPresentationMode){var i=e.fileInput.files[0];if(_pdf.URL.createObjectURL&&!_app_options.AppOptions.get("disableCreateObjectURL")){var t=_pdf.URL.createObjectURL(i);i.name&&(t={url:t,originalUrl:i.name}),PDFViewerApplication.open(t)}else{PDFViewerApplication.setTitleUsingUrl(i.name);var n=new FileReader;n.onload=function(e){var i=e.target.result;PDFViewerApplication.open(new Uint8Array(i))},n.readAsArrayBuffer(i)}var r=PDFViewerApplication.appConfig;r.toolbar.viewBookmark.setAttribute("hidden","true"),r.secondaryToolbar.viewBookmarkButton.setAttribute("hidden","true"),r.toolbar.download.setAttribute("hidden","true"),r.secondaryToolbar.downloadButton.setAttribute("hidden","true")}};var zoomDisabled=!1,zoomDisabledTimeout=void 0;function webViewerWheel(e){var i=PDFViewerApplication.pdfViewer;if(!i.isInPresentationMode)if(e.ctrlKey||e.metaKey){var t=PDFViewerApplication.supportedMouseWheelZoomModifierKeys;if(e.ctrlKey&&!t.ctrlKey||e.metaKey&&!t.metaKey)return;if(e.preventDefault(),zoomDisabled)return;var n=i.currentScale,r=(0,_ui_utils.normalizeWheelEventDelta)(e),o=3,a=r*o;a<0?PDFViewerApplication.zoomOut(-a):PDFViewerApplication.zoomIn(a);var s=i.currentScale;if(n!==s){var p=s/n-1,l=i.container.getBoundingClientRect(),d=e.clientX-l.left,c=e.clientY-l.top;i.container.scrollLeft+=d*p,i.container.scrollTop+=c*p}}else zoomDisabled=!0,clearTimeout(zoomDisabledTimeout),zoomDisabledTimeout=setTimeout((function(){zoomDisabled=!1}),1e3)}function webViewerClick(e){if(PDFViewerApplication.secondaryToolbar.isOpen){var i=PDFViewerApplication.appConfig;(PDFViewerApplication.pdfViewer.containsElement(e.target)||i.toolbar.container.contains(e.target)&&e.target!==i.secondaryToolbar.toggleButton)&&PDFViewerApplication.secondaryToolbar.close()}}function webViewerKeyDown(e){if(!PDFViewerApplication.overlayManager.active){var i=!1,t=!1,n=(e.ctrlKey?1:0)|(e.altKey?2:0)|(e.shiftKey?4:0)|(e.metaKey?8:0),r=PDFViewerApplication.pdfViewer,o=r&&r.isInPresentationMode;if(1===n||8===n||5===n||12===n)switch(e.keyCode){case 70:PDFViewerApplication.supportsIntegratedFind||(PDFViewerApplication.findBar.open(),i=!0);break;case 71:if(!PDFViewerApplication.supportsIntegratedFind){var a=PDFViewerApplication.findController.state;a&&PDFViewerApplication.findController.executeCommand("findagain",{query:a.query,phraseSearch:a.phraseSearch,caseSensitive:a.caseSensitive,entireWord:a.entireWord,highlightAll:a.highlightAll,findPrevious:5===n||12===n}),i=!0}break;case 61:case 107:case 187:case 171:o||PDFViewerApplication.zoomIn(),i=!0;break;case 173:case 109:case 189:o||PDFViewerApplication.zoomOut(),i=!0;break;case 48:case 96:o||(setTimeout((function(){r.currentScaleValue=_ui_utils.DEFAULT_SCALE_VALUE})),i=!1);break;case 38:(o||PDFViewerApplication.page>1)&&(PDFViewerApplication.page=1,i=!0,t=!0);break;case 40:(o||PDFViewerApplication.page<PDFViewerApplication.pagesCount)&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount,i=!0,t=!0);break}if(1===n||8===n)switch(e.keyCode){case 83:PDFViewerApplication.download(),i=!0;break}if(3===n||10===n)switch(e.keyCode){case 80:PDFViewerApplication.requestPresentationMode(),i=!0;break;case 71:PDFViewerApplication.appConfig.toolbar.pageNumber.select(),i=!0;break}if(i)return t&&!o&&r.focus(),void e.preventDefault();var s=document.activeElement||document.querySelector(":focus"),p=s&&s.tagName.toUpperCase();if("INPUT"!==p&&"TEXTAREA"!==p&&"SELECT"!==p||27===e.keyCode){if(0===n){var l=0,d=!1;switch(e.keyCode){case 38:case 33:r.isVerticalScrollbarEnabled&&(d=!0),l=-1;break;case 8:o||(d=!0),l=-1;break;case 37:r.isHorizontalScrollbarEnabled&&(d=!0);case 75:case 80:l=-1;break;case 27:PDFViewerApplication.secondaryToolbar.isOpen&&(PDFViewerApplication.secondaryToolbar.close(),i=!0),!PDFViewerApplication.supportsIntegratedFind&&PDFViewerApplication.findBar.opened&&(PDFViewerApplication.findBar.close(),i=!0);break;case 40:case 34:r.isVerticalScrollbarEnabled&&(d=!0),l=1;break;case 13:case 32:o||(d=!0),l=1;break;case 39:r.isHorizontalScrollbarEnabled&&(d=!0);case 74:case 78:l=1;break;case 36:(o||PDFViewerApplication.page>1)&&(PDFViewerApplication.page=1,i=!0,t=!0);break;case 35:(o||PDFViewerApplication.page<PDFViewerApplication.pagesCount)&&(PDFViewerApplication.page=PDFViewerApplication.pagesCount,i=!0,t=!0);break;case 83:PDFViewerApplication.pdfCursorTools.switchTool(_pdf_cursor_tools.CursorTool.SELECT);break;case 72:PDFViewerApplication.pdfCursorTools.switchTool(_pdf_cursor_tools.CursorTool.HAND);break;case 82:PDFViewerApplication.rotatePages(90);break}0===l||d&&"page-fit"!==r.currentScaleValue||(l>0?PDFViewerApplication.page<PDFViewerApplication.pagesCount&&PDFViewerApplication.page++:PDFViewerApplication.page>1&&PDFViewerApplication.page--,i=!0)}if(4===n)switch(e.keyCode){case 13:case 32:if(!o&&"page-fit"!==r.currentScaleValue)break;PDFViewerApplication.page>1&&PDFViewerApplication.page--,i=!0;break;case 82:PDFViewerApplication.rotatePages(-90);break}i||o||(e.keyCode>=33&&e.keyCode<=40||32===e.keyCode&&"BUTTON"!==p)&&(t=!0),t&&!r.containsElement(s)&&r.focus(),i&&e.preventDefault()}}}function apiPageModeToSidebarView(e){switch(e){case"UseNone":return _pdf_sidebar.SidebarView.NONE;case"UseThumbs":return _pdf_sidebar.SidebarView.THUMBS;case"UseOutlines":return _pdf_sidebar.SidebarView.OUTLINE;case"UseAttachments":return _pdf_sidebar.SidebarView.ATTACHMENTS;case"UseOC":}return _pdf_sidebar.SidebarView.NONE}var PDFPrintServiceFactory={instance:{supportsPrinting:!1,createPrintService:function(){throw new Error("Not implemented: createPrintService")}}};exports.PDFViewerApplication=PDFViewerApplication,exports.DefaultExternalServices=DefaultExternalServices,exports.PDFPrintServiceFactory=PDFPrintServiceFactory;