"use strict";var opMap,_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FontInspector=function(){var e,t,n=!1,a="data-font-name";function r(){for(var e=document.querySelectorAll("div["+a+"]"),t=0,n=e.length;t<n;++t){var r=e[t];r.className=""}}function i(){for(var e=document.querySelectorAll("div["+a+"]"),t=0,n=e.length;t<n;++t){var r=e[t];r.className="debuggerHideText"}}function o(e,t){for(var n=document.querySelectorAll("div["+a+"="+e+"]"),r=0,i=n.length;r<i;++r){var o=n[r];o.className=t?"debuggerShowText":"debuggerHideText"}}function d(e){if(e.target.dataset.fontName&&"DIV"===e.target.tagName.toUpperCase())for(var t=e.target.dataset.fontName,n=document.getElementsByTagName("input"),a=0;a<n.length;++a){var r=n[a];r.dataset.fontName===t&&(r.checked=!r.checked,o(t,r.checked),r.scrollIntoView())}}return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function(n){var a=this.panel;a.setAttribute("style","padding: 5px;");var r=document.createElement("button");r.addEventListener("click",i),r.textContent="Refresh",a.appendChild(r),e=document.createElement("div"),a.appendChild(e),t=n.createObjectURL},cleanup:function(){e.textContent=""},enabled:!1,get active(){return n},set active(e){n=e,n?(document.body.addEventListener("click",d,!0),i()):(document.body.removeEventListener("click",d,!0),r())},fontAdded:function(n,a){var r=this;function d(e,t){for(var n=document.createElement("table"),a=0;a<t.length;a++){var r=document.createElement("tr"),i=document.createElement("td");i.textContent=t[a],r.appendChild(i);var o=document.createElement("td");o.textContent=e[t[a]].toString(),r.appendChild(o),n.appendChild(r)}return n}var l=d(n,["name","type"]),s=n.loadedName,p=document.createElement("div"),c=document.createElement("span");c.textContent=s;var u=document.createElement("a");a?(a=/url\(['"]?([^\)"']+)/.exec(a),u.href=a[1]):n.data&&(u.href=t(n.data,n.mimeType)),u.textContent="Download";var h=document.createElement("a");h.href="",h.textContent="Log",h.addEventListener("click",(function(e){e.preventDefault(),console.log(n)}));var f=document.createElement("input");f.setAttribute("type","checkbox"),f.dataset.fontName=s,f.addEventListener("click",function(e,t){return function(){o(t,e.checked)}}(f,s)),p.appendChild(f),p.appendChild(c),p.appendChild(document.createTextNode(" ")),p.appendChild(u),p.appendChild(document.createTextNode(" ")),p.appendChild(h),p.appendChild(l),e.appendChild(p),setTimeout((function(){r.active&&i()}),2e3)}}}(),StepperManager=function(){var e=[],t=null,n=null,a=null,r=Object.create(null);return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function(e){var i=this;for(var o in this.panel.setAttribute("style","padding: 5px;"),n=document.createElement("div"),a=document.createElement("select"),a.addEventListener("change",(function(e){i.selectStepper(this.value)})),n.appendChild(a),t=document.createElement("div"),this.panel.appendChild(n),this.panel.appendChild(t),sessionStorage.getItem("pdfjsBreakPoints")&&(r=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))),opMap=Object.create(null),e.OPS)opMap[e.OPS[o]]=o},cleanup:function(){a.textContent="",t.textContent="",e=[]},enabled:!1,active:!1,create:function(n){var i=document.createElement("div");i.id="stepper"+n,i.setAttribute("hidden",!0),i.className="stepper",t.appendChild(i);var o=document.createElement("option");o.textContent="Page "+(n+1),o.value=n,a.appendChild(o);var d=r[n]||[],l=new Stepper(i,n,d);return e.push(l),1===e.length&&this.selectStepper(n,!1),l},selectStepper:function(t,n){var r;for(t|=0,n&&this.manager.selectPanel(this),r=0;r<e.length;++r){var i=e[r];i.pageIndex===t?i.panel.removeAttribute("hidden"):i.panel.setAttribute("hidden",!0)}var o=a.options;for(r=0;r<o.length;++r){var d=o[r];d.selected=(0|d.value)===t}},saveBreakPoints:function(e,t){r[e]=t,sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(r))}}}(),Stepper=function(){function e(e,t){var n=document.createElement(e);return t&&(n.textContent=t),n}function t(e){if("string"===typeof e){var n=75;return e.length<=n?e:e.substring(0,n)+"..."}if("object"!==("undefined"===typeof e?"undefined":_typeof(e))||null===e)return e;if("length"in e){var a,r,i=[],o=10;for(a=0,r=Math.min(o,e.length);a<r;a++)i.push(t(e[a]));return a<e.length&&i.push("..."),i}var d={};for(var l in e)d[l]=t(e[l]);return d}function n(e,t,n){this.panel=e,this.breakPoint=0,this.nextBreakPoint=null,this.pageIndex=t,this.breakPoints=n,this.currentIdx=-1,this.operatorListIdx=0}return n.prototype={init:function(t){var n=this.panel,a=e("div","c=continue, s=step"),r=e("table");a.appendChild(r),r.cellSpacing=0;var i=e("tr");r.appendChild(i),i.appendChild(e("th","Break")),i.appendChild(e("th","Idx")),i.appendChild(e("th","fn")),i.appendChild(e("th","args")),n.appendChild(a),this.table=r,this.updateOperatorList(t)},updateOperatorList:function(n){var a=this;function r(){var e=+this.dataset.idx;this.checked?a.breakPoints.push(e):a.breakPoints.splice(a.breakPoints.indexOf(e),1),StepperManager.saveBreakPoints(a.pageIndex,a.breakPoints)}var i=15e3;if(!(this.operatorListIdx>i)){for(var o=document.createDocumentFragment(),d=Math.min(i,n.fnArray.length),l=this.operatorListIdx;l<d;l++){var s=e("tr");s.className="line",s.dataset.idx=l,o.appendChild(s);var p=this.breakPoints.includes(l),c=n.argsArray[l]||[],u=e("td"),h=e("input");h.type="checkbox",h.className="points",h.checked=p,h.dataset.idx=l,h.onclick=r,u.appendChild(h),s.appendChild(u),s.appendChild(e("td",l.toString()));var f=opMap[n.fnArray[l]],v=c;if("showText"===f){for(var m=c[0],g=[],b=[],C=0;C<m.length;C++){var x=m[C];"object"===("undefined"===typeof x?"undefined":_typeof(x))&&null!==x?b.push(x.fontChar):(b.length>0&&(g.push(b.join("")),b=[]),g.push(x))}b.length>0&&g.push(b.join("")),v=[g]}s.appendChild(e("td",f)),s.appendChild(e("td",JSON.stringify(t(v))))}if(d<n.fnArray.length){s=e("tr");var y=e("td","...");y.colspan=4,o.appendChild(y)}this.operatorListIdx=n.fnArray.length,this.table.appendChild(o)}},getNextBreakPoint:function(){this.breakPoints.sort((function(e,t){return e-t}));for(var e=0;e<this.breakPoints.length;e++)if(this.breakPoints[e]>this.currentIdx)return this.breakPoints[e];return null},breakIt:function(e,t){StepperManager.selectStepper(this.pageIndex,!0);var n=this,a=document;n.currentIdx=e;var r=function e(r){switch(r.keyCode){case 83:a.removeEventListener("keydown",e),n.nextBreakPoint=n.currentIdx+1,n.goTo(-1),t();break;case 67:a.removeEventListener("keydown",e);var i=n.getNextBreakPoint();n.nextBreakPoint=i,n.goTo(-1),t();break}};a.addEventListener("keydown",r),n.goTo(e)},goTo:function(e){for(var t=this.panel.getElementsByClassName("line"),n=0,a=t.length;n<a;++n){var r=t[n];(0|r.dataset.idx)===e?(r.style.backgroundColor="rgb(251,250,207)",r.scrollIntoView()):r.style.backgroundColor=null}}},n}(),Stats=function(){var e=[];function t(e){while(e.hasChildNodes())e.removeChild(e.lastChild)}function n(t){for(var n=0,a=e.length;n<a;++n)if(e[n].pageNumber===t)return n;return!1}return{id:"Stats",name:"Stats",panel:null,manager:null,init:function(e){this.panel.setAttribute("style","padding: 5px;")},enabled:!1,active:!1,add:function(a,r){if(r){var i=n(a);if(!1!==i){var o=e[i];this.panel.removeChild(o.div),e.splice(i,1)}var d=document.createElement("div");d.className="stats";var l=document.createElement("div");l.className="title",l.textContent="Page: "+a;var s=document.createElement("div");s.textContent=r.toString(),d.appendChild(l),d.appendChild(s),e.push({pageNumber:a,div:d}),e.sort((function(e,t){return e.pageNumber-t.pageNumber})),t(this.panel);for(var p=0,c=e.length;p<c;++p)this.panel.appendChild(e[p].div)}},cleanup:function(){e=[],t(this.panel)}}}();window.PDFBug=function(){var e=300,t=[],n=null;return{tools:[FontInspector,StepperManager,Stats],enable:function(e){var t=!1,n=this.tools;1===e.length&&"all"===e[0]&&(t=!0);for(var a=0;a<n.length;++a){var r=n[a];(t||e.includes(r.id))&&(r.enabled=!0)}t||n.sort((function(t,a){var r=e.indexOf(t.id);r=r<0?n.length:r;var i=e.indexOf(a.id);return i=i<0?n.length:i,r-i}))},init:function(n,a){var r=document.createElement("div");r.id="PDFBug";var i=document.createElement("div");i.setAttribute("class","controls"),r.appendChild(i);var o=document.createElement("div");o.setAttribute("class","panels"),r.appendChild(o),a.appendChild(r),a.style.right=e+"px";for(var d=this.tools,l=this,s=0;s<d.length;++s){var p=d[s],c=document.createElement("div"),u=document.createElement("button");u.textContent=p.name,u.addEventListener("click",function(e){return function(t){t.preventDefault(),l.selectPanel(e)}}(s)),i.appendChild(u),o.appendChild(c),p.panel=c,p.manager=this,p.enabled?p.init(n):c.textContent=p.name+' is disabled. To enable add  "'+p.id+'" to the pdfBug parameter and refresh (separate multiple by commas).',t.push(u)}this.selectPanel(0)},cleanup:function(){for(var e=0,t=this.tools.length;e<t;e++)this.tools[e].enabled&&this.tools[e].cleanup()},selectPanel:function(e){if("number"!==typeof e&&(e=this.tools.indexOf(e)),e!==n){n=e;for(var a=this.tools,r=0;r<a.length;++r)r===e?(t[r].setAttribute("class","active"),a[r].active=!0,a[r].panel.removeAttribute("hidden")):(t[r].setAttribute("class",""),a[r].active=!1,a[r].panel.setAttribute("hidden","true"))}}}}();