"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FirefoxPrintService=void 0;var _ui_utils=require("./ui_utils"),_app=require("./app"),_pdf=require("../pdf");function composePage(e,t,i,r){var n=document.createElement("canvas"),o=150,a=o/72;n.width=Math.floor(i.width*a),n.height=Math.floor(i.height*a),n.style.width=Math.floor(i.width*_ui_utils.CSS_UNITS)+"px",n.style.height=Math.floor(i.height*_ui_utils.CSS_UNITS)+"px";var s=document.createElement("div");s.appendChild(n),r.appendChild(s),n.mozPrintCallback=function(r){var o=r.context;o.save(),o.fillStyle="rgb(255, 255, 255)",o.fillRect(0,0,n.width,n.height),o.restore(),e.getPage(t).then((function(e){var t={canvasContext:o,transform:[a,0,0,a,0,0],viewport:e.getViewport(1,i.rotation),intent:"print"};return e.render(t).promise})).then((function(){r.done()}),(function(e){console.error(e),"abort"in r?r.abort():r.done()}))}}function FirefoxPrintService(e,t,i){this.pdfDocument=e,this.pagesOverview=t,this.printContainer=i}FirefoxPrintService.prototype={layout:function(){var e=this.pdfDocument,t=this.printContainer,i=document.querySelector("body");i.setAttribute("data-pdfjsprinting",!0);for(var r=0,n=this.pagesOverview.length;r<n;++r)composePage(e,r+1,this.pagesOverview[r],t)},destroy:function(){this.printContainer.textContent=""}},_app.PDFPrintServiceFactory.instance={get supportsPrinting(){var e=document.createElement("canvas"),t="mozPrintCallback"in e;return(0,_pdf.shadow)(this,"supportsPrinting",t)},createPrintService:function(e,t,i){return new FirefoxPrintService(e,t,i)}},exports.FirefoxPrintService=FirefoxPrintService;