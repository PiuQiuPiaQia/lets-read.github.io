"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.moveToEndOfArray=exports.waitOnEventOrTimeout=exports.WaitOnType=exports.animationStarted=exports.normalizeWheelEventDelta=exports.binarySearchFirstItem=exports.watchScroll=exports.scrollIntoView=exports.getOutputScale=exports.approximateFraction=exports.getPageSizeInches=exports.roundToDivide=exports.getVisibleElements=exports.backtrackBeforeAllVisibleElements=exports.parseQueryString=exports.noContextMenuHandler=exports.getPDFFileNameFromURL=exports.ProgressBar=exports.EventBus=exports.NullL10n=exports.TextLayerMode=exports.RendererType=exports.PresentationModeState=exports.isPortraitOrientation=exports.isValidRotation=exports.VERTICAL_PADDING=exports.SCROLLBAR_PADDING=exports.MAX_AUTO_SCALE=exports.UNKNOWN_SCALE=exports.MAX_SCALE=exports.MIN_SCALE=exports.DEFAULT_SCALE=exports.DEFAULT_SCALE_VALUE=exports.CSS_UNITS=void 0;var _regenerator=require("babel-runtime/regenerator"),_regenerator2=_interopRequireDefault(_regenerator),_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_slicedToArray=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)if(r.push(a.value),t&&r.length===t)break}catch(l){i=!0,o=l}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){function n(i,o){try{var a=t[i](o),s=a.value}catch(l){return void r(l)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}return n("next")}))}}var CSS_UNITS=96/72,DEFAULT_SCALE_VALUE="auto",DEFAULT_SCALE=1,MIN_SCALE=.1,MAX_SCALE=10,UNKNOWN_SCALE=0,MAX_AUTO_SCALE=1.25,SCROLLBAR_PADDING=40,VERTICAL_PADDING=5,PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},RendererType={CANVAS:"canvas",SVG:"svg"},TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_ENHANCE:2};function formatL10nValue(e,t){return t?e.replace(/\{\{\s*(\w+)\s*\}\}/g,(function(e,r){return r in t?t[r]:"{{"+r+"}}"})):e}var NullL10n={getLanguage:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(){return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return","en-us");case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getDirection:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(){return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return","ltr");case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),get:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(t,r,n){return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",formatL10nValue(n,r));case 1:case"end":return e.stop()}}),e,this)})));function t(t,r,n){return e.apply(this,arguments)}return t}(),translate:function(){var e=_asyncToGenerator(_regenerator2.default.mark((function e(t){return _regenerator2.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()};function getOutputScale(e){var t=window.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,n=t/r;return{sx:n,sy:n,scaled:1!==n}}function scrollIntoView(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.offsetParent;if(n){var i=e.offsetTop+e.clientTop,o=e.offsetLeft+e.clientLeft;while(n.clientHeight===n.scrollHeight&&n.clientWidth===n.scrollWidth||r&&"hidden"===getComputedStyle(n).overflow)if(n.dataset._scaleY&&(i/=n.dataset._scaleY,o/=n.dataset._scaleX),i+=n.offsetTop,o+=n.offsetLeft,n=n.offsetParent,!n)return;t&&(void 0!==t.top&&(i+=t.top),void 0!==t.left&&(o+=t.left,n.scrollLeft=o)),n.scrollTop=i}else console.error("offsetParent is not set -- cannot scroll")}function watchScroll(e,t){var r=function(r){i||(i=window.requestAnimationFrame((function(){i=null;var r=e.scrollLeft,o=n.lastX;r!==o&&(n.right=r>o),n.lastX=r;var a=e.scrollTop,s=n.lastY;a!==s&&(n.down=a>s),n.lastY=a,t(n)})))},n={right:!0,down:!0,lastX:e.scrollLeft,lastY:e.scrollTop,_eventHandler:r},i=null;return e.addEventListener("scroll",r,!0),n}function parseQueryString(e){for(var t=e.split("&"),r=Object.create(null),n=0,i=t.length;n<i;++n){var o=t[n].split("="),a=o[0].toLowerCase(),s=o.length>1?o[1]:null;r[decodeURIComponent(a)]=decodeURIComponent(s)}return r}function binarySearchFirstItem(e,t){var r=0,n=e.length-1;if(0===e.length||!t(e[n]))return e.length;if(t(e[r]))return r;while(r<n){var i=r+n>>1,o=e[i];t(o)?n=i:r=i+1}return r}function approximateFraction(e){if(Math.floor(e)===e)return[e,1];var t=1/e,r=8;if(t>r)return[1,r];if(Math.floor(t)===t)return[1,t];var n=e>1?t:e,i=0,o=1,a=1,s=1;while(1){var l=i+a,u=o+s;if(u>r)break;n<=l/u?(a=l,s=u):(i=l,o=u)}var c=void 0;return c=n-i/o<a/s-n?n===e?[i,o]:[o,i]:n===e?[a,s]:[s,a],c}function roundToDivide(e,t){var r=e%t;return 0===r?e:Math.round(e-r+t)}function getPageSizeInches(e){var t=e.view,r=e.userUnit,n=e.rotate,i=_slicedToArray(t,4),o=i[0],a=i[1],s=i[2],l=i[3],u=n%180!==0,c=(s-o)/72*r,f=(l-a)/72*r;return{width:u?f:c,height:u?c:f}}function backtrackBeforeAllVisibleElements(e,t,r){if(e<2)return e;var n=t[e].div,i=n.offsetTop+n.clientTop;i>=r&&(n=t[e-1].div,i=n.offsetTop+n.clientTop);for(var o=e-2;o>=0;--o){if(n=t[o].div,n.offsetTop+n.clientTop+n.clientHeight<=i)break;e=o}return e}function getVisibleElements(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e.scrollTop,o=i+e.clientHeight,a=e.scrollLeft,s=a+e.clientWidth;function l(e){var t=e.div,r=t.offsetTop+t.clientTop+t.clientHeight;return r>i}function u(e){var t=e.div,r=t.offsetLeft+t.clientLeft+t.clientWidth;return r>a}var c=[],f=void 0,d=void 0,p=void 0,h=void 0,v=void 0,m=void 0,x=void 0,g=void 0,_=void 0,y=void 0,E=void 0,L=0===t.length?0:binarySearchFirstItem(t,n?u:l);t.length>0&&!n&&(L=backtrackBeforeAllVisibleElements(L,t,i));for(var A=n?s:-1,S=L,T=t.length;S<T;S++){if(f=t[S],d=f.div,x=d.offsetLeft+d.clientLeft,p=d.offsetTop+d.clientTop,g=d.clientWidth,h=d.clientHeight,_=x+g,v=p+h,-1===A)v>=o&&(A=v);else if((n?x:p)>A)break;v<=i||p>=o||_<=a||x>=s||(m=Math.max(0,i-p)+Math.max(0,v-o),y=Math.max(0,a-x)+Math.max(0,_-s),E=(h-m)*(g-y)*100/h/g|0,c.push({id:f.id,x:x,y:p,view:f,percent:E}))}var w=c[0],b=c[c.length-1];return r&&c.sort((function(e,t){var r=e.percent-t.percent;return Math.abs(r)>.001?-r:e.id-t.id})),{first:w,last:b,views:c}}function noContextMenuHandler(e){e.preventDefault()}function isDataSchema(e){var t=0,r=e.length;while(t<r&&""===e[t].trim())t++;return"data:"===e.substring(t,t+5).toLowerCase()}function getPDFFileNameFromURL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!==typeof e)return t;if(isDataSchema(e))return console.warn('getPDFFileNameFromURL: ignoring "data:" URL for performance reasons.'),t;var r=/^(?:(?:[^:]+:)?\/\/[^\/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,n=/[^\/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=r.exec(e),o=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(o&&(o=o[0],o.includes("%")))try{o=n.exec(decodeURIComponent(o))[0]}catch(a){}return o||t}function normalizeWheelEventDelta(e){var t=Math.sqrt(e.deltaX*e.deltaX+e.deltaY*e.deltaY),r=Math.atan2(e.deltaY,e.deltaX);-.25*Math.PI<r&&r<.75*Math.PI&&(t=-t);var n=0,i=1,o=30,a=30;return e.deltaMode===n?t/=o*a:e.deltaMode===i&&(t/=a),t}function isValidRotation(e){return Number.isInteger(e)&&e%90===0}function isPortraitOrientation(e){return e.width<=e.height}var WaitOnType={EVENT:"event",TIMEOUT:"timeout"};function waitOnEventOrTimeout(e){var t=e.target,r=e.name,n=e.delay,i=void 0===n?0:n;return new Promise((function(e,n){if("object"!==("undefined"===typeof t?"undefined":_typeof(t))||!r||"string"!==typeof r||!(Number.isInteger(i)&&i>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function o(n){t instanceof EventBus?t.off(r,a):t.removeEventListener(r,a),l&&clearTimeout(l),e(n)}var a=o.bind(null,WaitOnType.EVENT);t instanceof EventBus?t.on(r,a):t.addEventListener(r,a);var s=o.bind(null,WaitOnType.TIMEOUT),l=setTimeout(s,i)}))}var animationStarted=new Promise((function(e){"undefined"!==typeof window?window.requestAnimationFrame(e):setTimeout(e,20)})),EventBus=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.dispatchToDOM,n=void 0!==r&&r;_classCallCheck(this,e),this._listeners=Object.create(null),this._dispatchToDOM=!0===n}return _createClass(e,[{key:"on",value:function(e,t){var r=this._listeners[e];r||(r=[],this._listeners[e]=r),r.push(t)}},{key:"off",value:function(e,t){var r=this._listeners[e],n=void 0;!r||(n=r.indexOf(t))<0||r.splice(n,1)}},{key:"dispatch",value:function(e){var t=this._listeners[e];if(t&&0!==t.length){var r=Array.prototype.slice.call(arguments,1);t.slice(0).forEach((function(e){e.apply(null,r)})),this._dispatchToDOM&&this._dispatchDOMEvent(e,r)}else if(this._dispatchToDOM){var n=Array.prototype.slice.call(arguments,1);this._dispatchDOMEvent(e,n)}}},{key:"_dispatchDOMEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._dispatchToDOM){var r=Object.create(null);if(t&&t.length>0){var n=t[0];for(var i in n){var o=n[i];if("source"!==i)r[i]=o;else if(o===window||o===document)return}}var a=document.createEvent("CustomEvent");a.initCustomEvent(e,!0,!0,r),document.dispatchEvent(a)}}}]),e}();function clamp(e,t,r){return Math.min(Math.max(e,t),r)}var ProgressBar=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.height,i=r.width,o=r.units;_classCallCheck(this,e),this.visible=!0,this.div=document.querySelector(t+" .progress"),this.bar=this.div.parentNode,this.height=n||100,this.width=i||100,this.units=o||"%",this.div.style.height=this.height+this.units,this.percent=0}return _createClass(e,[{key:"_updateBar",value:function(){if(this._indeterminate)return this.div.classList.add("indeterminate"),void(this.div.style.width=this.width+this.units);this.div.classList.remove("indeterminate");var e=this.width*this._percent/100;this.div.style.width=e+this.units}},{key:"setWidth",value:function(e){if(e){var t=e.parentNode,r=t.offsetWidth-e.offsetWidth;r>0&&this.bar.setAttribute("style","width: calc(100% - "+r+"px);")}}},{key:"hide",value:function(){this.visible&&(this.visible=!1,this.bar.classList.add("hidden"),document.body.classList.remove("loadingInProgress"))}},{key:"show",value:function(){this.visible||(this.visible=!0,document.body.classList.add("loadingInProgress"),this.bar.classList.remove("hidden"))}},{key:"percent",get:function(){return this._percent},set:function(e){this._indeterminate=isNaN(e),this._percent=clamp(e,0,100),this._updateBar()}}]),e}();function moveToEndOfArray(e,t){for(var r=[],n=e.length,i=0,o=0;o<n;++o)t(e[o])?r.push(e[o]):(e[i]=e[o],++i);for(var a=0;i<n;++a,++i)e[i]=r[a]}exports.CSS_UNITS=CSS_UNITS,exports.DEFAULT_SCALE_VALUE=DEFAULT_SCALE_VALUE,exports.DEFAULT_SCALE=DEFAULT_SCALE,exports.MIN_SCALE=MIN_SCALE,exports.MAX_SCALE=MAX_SCALE,exports.UNKNOWN_SCALE=UNKNOWN_SCALE,exports.MAX_AUTO_SCALE=MAX_AUTO_SCALE,exports.SCROLLBAR_PADDING=SCROLLBAR_PADDING,exports.VERTICAL_PADDING=VERTICAL_PADDING,exports.isValidRotation=isValidRotation,exports.isPortraitOrientation=isPortraitOrientation,exports.PresentationModeState=PresentationModeState,exports.RendererType=RendererType,exports.TextLayerMode=TextLayerMode,exports.NullL10n=NullL10n,exports.EventBus=EventBus,exports.ProgressBar=ProgressBar,exports.getPDFFileNameFromURL=getPDFFileNameFromURL,exports.noContextMenuHandler=noContextMenuHandler,exports.parseQueryString=parseQueryString,exports.backtrackBeforeAllVisibleElements=backtrackBeforeAllVisibleElements,exports.getVisibleElements=getVisibleElements,exports.roundToDivide=roundToDivide,exports.getPageSizeInches=getPageSizeInches,exports.approximateFraction=approximateFraction,exports.getOutputScale=getOutputScale,exports.scrollIntoView=scrollIntoView,exports.watchScroll=watchScroll,exports.binarySearchFirstItem=binarySearchFirstItem,exports.normalizeWheelEventDelta=normalizeWheelEventDelta,exports.animationStarted=animationStarted,exports.WaitOnType=WaitOnType,exports.waitOnEventOrTimeout=waitOnEventOrTimeout,exports.moveToEndOfArray=moveToEndOfArray;