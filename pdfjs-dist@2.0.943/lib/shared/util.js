"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.unreachable=exports.warn=exports.utf8StringToString=exports.stringToUTF8String=exports.stringToPDFString=exports.stringToBytes=exports.string32=exports.shadow=exports.setVerbosityLevel=exports.URL=exports.ReadableStream=exports.removeNullCharacters=exports.readUint32=exports.readUint16=exports.readInt8=exports.log2=exports.isEvalSupported=exports.isLittleEndian=exports.createValidAbsoluteUrl=exports.isSameOrigin=exports.isSpace=exports.isString=exports.isNum=exports.isEmptyObj=exports.isBool=exports.isArrayBuffer=exports.info=exports.getVerbosityLevel=exports.getLookupTableFactory=exports.getInheritableProperty=exports.deprecated=exports.createObjectURL=exports.createPromiseCapability=exports.bytesToString=exports.assert=exports.arraysToBytes=exports.arrayByteLength=exports.FormatError=exports.XRefParseException=exports.toRomanNumerals=exports.Util=exports.UnknownErrorException=exports.UnexpectedResponseException=exports.TextRenderingMode=exports.StreamType=exports.PermissionFlag=exports.PasswordResponses=exports.PasswordException=exports.NativeImageDecoding=exports.MissingPDFException=exports.MissingDataException=exports.InvalidPDFException=exports.AbortException=exports.CMapCompressionType=exports.ImageKind=exports.FontType=exports.AnnotationType=exports.AnnotationFlag=exports.AnnotationFieldFlag=exports.AnnotationBorderStyleType=exports.UNSUPPORTED_FEATURES=exports.VerbosityLevel=exports.OPS=exports.IDENTITY_MATRIX=exports.FONT_IDENTITY_MATRIX=void 0;var _typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};require("./compatibility");var _streams_polyfill=require("./streams_polyfill"),_url_polyfill=require("./url_polyfill"),IDENTITY_MATRIX=[1,0,0,1,0,0],FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],NativeImageDecoding={NONE:"none",DECODE:"decode",DISPLAY:"display"},PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},StreamType={UNKNOWN:0,FLATE:1,LZW:2,DCT:3,JPX:4,JBIG:5,A85:6,AHX:7,CCF:8,RL:9},FontType={UNKNOWN:0,TYPE1:1,TYPE1C:2,CIDFONTTYPE0:3,CIDFONTTYPE0C:4,TRUETYPE:5,CIDFONTTYPE2:6,TYPE3:7,OPENTYPE:8,TYPE0:9,MMTYPE1:10},VerbosityLevel={ERRORS:0,WARNINGS:1,INFOS:5},CMapCompressionType={NONE:0,BINARY:1,STREAM:2},OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},verbosity=VerbosityLevel.WARNINGS;function setVerbosityLevel(e){Number.isInteger(e)&&(verbosity=e)}function getVerbosityLevel(){return verbosity}function info(e){verbosity>=VerbosityLevel.INFOS&&console.log("Info: "+e)}function warn(e){verbosity>=VerbosityLevel.WARNINGS&&console.log("Warning: "+e)}function deprecated(e){console.log("Deprecated API usage: "+e)}function unreachable(e){throw new Error(e)}function assert(e,t){e||unreachable(t)}function isSameOrigin(e,t){try{var r=new _url_polyfill.URL(e);if(!r.origin||"null"===r.origin)return!1}catch(n){return!1}var o=new _url_polyfill.URL(t,r);return r.origin===o.origin}function _isValidProtocol(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function createValidAbsoluteUrl(e,t){if(!e)return null;try{var r=t?new _url_polyfill.URL(e,t):new _url_polyfill.URL(e);if(_isValidProtocol(r))return r}catch(o){}return null}function shadow(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!1}),r}function getLookupTableFactory(e){var t;return function(){return e&&(t=Object.create(null),e(t),e=null),t}}var PasswordException=function(){function e(e,t){this.name="PasswordException",this.message=e,this.code=t}return e.prototype=new Error,e.constructor=e,e}(),UnknownErrorException=function(){function e(e,t){this.name="UnknownErrorException",this.message=e,this.details=t}return e.prototype=new Error,e.constructor=e,e}(),InvalidPDFException=function(){function e(e){this.name="InvalidPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}(),MissingPDFException=function(){function e(e){this.name="MissingPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}(),UnexpectedResponseException=function(){function e(e,t){this.name="UnexpectedResponseException",this.message=e,this.status=t}return e.prototype=new Error,e.constructor=e,e}(),MissingDataException=function(){function e(e,t){this.begin=e,this.end=t,this.message="Missing data ["+e+", "+t+")"}return e.prototype=new Error,e.prototype.name="MissingDataException",e.constructor=e,e}(),XRefParseException=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="XRefParseException",e.constructor=e,e}(),FormatError=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="FormatError",e.constructor=e,e}(),AbortException=function(){function e(e){this.name="AbortException",this.message=e}return e.prototype=new Error,e.constructor=e,e}(),NullCharactersRegExp=/\x00/g;function removeNullCharacters(e){return"string"!==typeof e?(warn("The argument for removeNullCharacters must be a string."),e):e.replace(NullCharactersRegExp,"")}function bytesToString(e){assert(null!==e&&"object"===("undefined"===typeof e?"undefined":_typeof(e))&&void 0!==e.length,"Invalid argument for bytesToString");var t=e.length,r=8192;if(t<r)return String.fromCharCode.apply(null,e);for(var o=[],n=0;n<t;n+=r){var i=Math.min(n+r,t),s=e.subarray(n,i);o.push(String.fromCharCode.apply(null,s))}return o.join("")}function stringToBytes(e){assert("string"===typeof e,"Invalid argument for stringToBytes");for(var t=e.length,r=new Uint8Array(t),o=0;o<t;++o)r[o]=255&e.charCodeAt(o);return r}function arrayByteLength(e){return void 0!==e.length?e.length:(assert(void 0!==e.byteLength),e.byteLength)}function arraysToBytes(e){if(1===e.length&&e[0]instanceof Uint8Array)return e[0];var t,r,o,n=0,i=e.length;for(t=0;t<i;t++)r=e[t],o=arrayByteLength(r),n+=o;var s=0,a=new Uint8Array(n);for(t=0;t<i;t++)r=e[t],r instanceof Uint8Array||(r="string"===typeof r?stringToBytes(r):new Uint8Array(r)),o=r.byteLength,a.set(r,s),s+=o;return a}function string32(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function log2(e){return e<=0?0:Math.ceil(Math.log2(e))}function readInt8(e,t){return e[t]<<24>>24}function readUint16(e,t){return e[t]<<8|e[t+1]}function readUint32(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function isLittleEndian(){var e=new Uint8Array(4);e[0]=1;var t=new Uint32Array(e.buffer,0,1);return 1===t[0]}function isEvalSupported(){try{return new Function(""),!0}catch(e){return!1}}function getInheritableProperty(e){var t=e.dict,r=e.key,o=e.getArray,n=void 0!==o&&o,i=e.stopWhenFound,s=void 0===i||i,a=100,p=0,l=void 0;while(t){var c=n?t.getArray(r):t.get(r);if(void 0!==c){if(s)return c;l||(l=[]),l.push(c)}if(++p>a){warn('getInheritableProperty: maximum loop count exceeded for "'+r+'"');break}t=t.get("Parent")}return l}var Util=function(){function e(){}var t=["rgb(",0,",",0,",",0,")"];return e.makeCssRgb=function(e,r,o){return t[1]=e,t[3]=r,t[5]=o,t.join("")},e.transform=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},e.applyTransform=function(e,t){var r=e[0]*t[0]+e[1]*t[2]+t[4],o=e[0]*t[1]+e[1]*t[3]+t[5];return[r,o]},e.applyInverseTransform=function(e,t){var r=t[0]*t[3]-t[1]*t[2],o=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/r,n=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/r;return[o,n]},e.getAxialAlignedBoundingBox=function(t,r){var o=e.applyTransform(t,r),n=e.applyTransform(t.slice(2,4),r),i=e.applyTransform([t[0],t[3]],r),s=e.applyTransform([t[2],t[1]],r);return[Math.min(o[0],n[0],i[0],s[0]),Math.min(o[1],n[1],i[1],s[1]),Math.max(o[0],n[0],i[0],s[0]),Math.max(o[1],n[1],i[1],s[1])]},e.inverseTransform=function(e){var t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]},e.apply3dTransform=function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]},e.singularValueDecompose2dScale=function(e){var t=[e[0],e[2],e[1],e[3]],r=e[0]*t[0]+e[1]*t[2],o=e[0]*t[1]+e[1]*t[3],n=e[2]*t[0]+e[3]*t[2],i=e[2]*t[1]+e[3]*t[3],s=(r+i)/2,a=Math.sqrt((r+i)*(r+i)-4*(r*i-n*o))/2,p=s+a||1,l=s-a||1;return[Math.sqrt(p),Math.sqrt(l)]},e.normalizeRect=function(e){var t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t},e.intersect=function(t,r){function o(e,t){return e-t}var n=[t[0],t[2],r[0],r[2]].sort(o),i=[t[1],t[3],r[1],r[3]].sort(o),s=[];return t=e.normalizeRect(t),r=e.normalizeRect(r),(n[0]===t[0]&&n[1]===r[0]||n[0]===r[0]&&n[1]===t[0])&&(s[0]=n[1],s[2]=n[2],(i[0]===t[1]&&i[1]===r[1]||i[0]===r[1]&&i[1]===t[1])&&(s[1]=i[1],s[3]=i[2],s))},e}(),ROMAN_NUMBER_MAP=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];function toRomanNumerals(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];assert(Number.isInteger(e)&&e>0,"The number should be a positive integer.");var r=void 0,o=[];while(e>=1e3)e-=1e3,o.push("M");r=e/100|0,e%=100,o.push(ROMAN_NUMBER_MAP[r]),r=e/10|0,e%=10,o.push(ROMAN_NUMBER_MAP[10+r]),o.push(ROMAN_NUMBER_MAP[20+e]);var n=o.join("");return t?n.toLowerCase():n}var PDFStringTranslateTable=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function stringToPDFString(e){var t,r=e.length,o=[];if("\xfe"===e[0]&&"\xff"===e[1])for(t=2;t<r;t+=2)o.push(String.fromCharCode(e.charCodeAt(t)<<8|e.charCodeAt(t+1)));else for(t=0;t<r;++t){var n=PDFStringTranslateTable[e.charCodeAt(t)];o.push(n?String.fromCharCode(n):e.charAt(t))}return o.join("")}function stringToUTF8String(e){return decodeURIComponent(escape(e))}function utf8StringToString(e){return unescape(encodeURIComponent(e))}function isEmptyObj(e){for(var t in e)return!1;return!0}function isBool(e){return"boolean"===typeof e}function isNum(e){return"number"===typeof e}function isString(e){return"string"===typeof e}function isArrayBuffer(e){return"object"===("undefined"===typeof e?"undefined":_typeof(e))&&null!==e&&void 0!==e.byteLength}function isSpace(e){return 32===e||9===e||13===e||10===e}function createPromiseCapability(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}var createObjectURL=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return function(t,r){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!o&&_url_polyfill.URL.createObjectURL){var n=new Blob([t],{type:r});return _url_polyfill.URL.createObjectURL(n)}for(var i="data:"+r+";base64,",s=0,a=t.length;s<a;s+=3){var p=255&t[s],l=255&t[s+1],c=255&t[s+2],u=p>>2,T=(3&p)<<4|l>>4,g=s+1<a?(15&l)<<2|c>>6:64,x=s+2<a?63&c:64;i+=e[u]+e[T]+e[g]+e[x]}return i}}();exports.FONT_IDENTITY_MATRIX=FONT_IDENTITY_MATRIX,exports.IDENTITY_MATRIX=IDENTITY_MATRIX,exports.OPS=OPS,exports.VerbosityLevel=VerbosityLevel,exports.UNSUPPORTED_FEATURES=UNSUPPORTED_FEATURES,exports.AnnotationBorderStyleType=AnnotationBorderStyleType,exports.AnnotationFieldFlag=AnnotationFieldFlag,exports.AnnotationFlag=AnnotationFlag,exports.AnnotationType=AnnotationType,exports.FontType=FontType,exports.ImageKind=ImageKind,exports.CMapCompressionType=CMapCompressionType,exports.AbortException=AbortException,exports.InvalidPDFException=InvalidPDFException,exports.MissingDataException=MissingDataException,exports.MissingPDFException=MissingPDFException,exports.NativeImageDecoding=NativeImageDecoding,exports.PasswordException=PasswordException,exports.PasswordResponses=PasswordResponses,exports.PermissionFlag=PermissionFlag,exports.StreamType=StreamType,exports.TextRenderingMode=TextRenderingMode,exports.UnexpectedResponseException=UnexpectedResponseException,exports.UnknownErrorException=UnknownErrorException,exports.Util=Util,exports.toRomanNumerals=toRomanNumerals,exports.XRefParseException=XRefParseException,exports.FormatError=FormatError,exports.arrayByteLength=arrayByteLength,exports.arraysToBytes=arraysToBytes,exports.assert=assert,exports.bytesToString=bytesToString,exports.createPromiseCapability=createPromiseCapability,exports.createObjectURL=createObjectURL,exports.deprecated=deprecated,exports.getInheritableProperty=getInheritableProperty,exports.getLookupTableFactory=getLookupTableFactory,exports.getVerbosityLevel=getVerbosityLevel,exports.info=info,exports.isArrayBuffer=isArrayBuffer,exports.isBool=isBool,exports.isEmptyObj=isEmptyObj,exports.isNum=isNum,exports.isString=isString,exports.isSpace=isSpace,exports.isSameOrigin=isSameOrigin,exports.createValidAbsoluteUrl=createValidAbsoluteUrl,exports.isLittleEndian=isLittleEndian,exports.isEvalSupported=isEvalSupported,exports.log2=log2,exports.readInt8=readInt8,exports.readUint16=readUint16,exports.readUint32=readUint32,exports.removeNullCharacters=removeNullCharacters,exports.ReadableStream=_streams_polyfill.ReadableStream,exports.URL=_url_polyfill.URL,exports.setVerbosityLevel=setVerbosityLevel,exports.shadow=shadow,exports.string32=string32,exports.stringToBytes=stringToBytes,exports.stringToPDFString=stringToPDFString,exports.stringToUTF8String=stringToUTF8String,exports.utf8StringToString=utf8StringToString,exports.warn=warn,exports.unreachable=unreachable;