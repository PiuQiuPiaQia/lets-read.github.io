"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFSidebarResizer=void 0;const SIDEBAR_WIDTH_VAR="--sidebar-width",SIDEBAR_MIN_WIDTH=200,SIDEBAR_RESIZING_CLASS="sidebarResizing";class PDFSidebarResizer{constructor(e,t,i){this.isRTL=!1,this.sidebarOpen=!1,this.doc=document.documentElement,this._width=null,this._outerContainerWidth=null,this._boundEvents=Object.create(null),this.outerContainer=e.outerContainer,this.resizer=e.resizer,this.eventBus=t,i.getDirection().then((e=>{this.isRTL="rtl"===e})),this._addEventListeners()}get outerContainerWidth(){return this._outerContainerWidth||=this.outerContainer.clientWidth}_updateWidth(e=0){const t=Math.floor(this.outerContainerWidth/2);return e>t&&(e=t),e<SIDEBAR_MIN_WIDTH&&(e=SIDEBAR_MIN_WIDTH),e!==this._width&&(this._width=e,this.doc.style.setProperty(SIDEBAR_WIDTH_VAR,`${e}px`),!0)}_mouseMove(e){let t=e.clientX;this.isRTL&&(t=this.outerContainerWidth-t),this._updateWidth(t)}_mouseUp(e){this.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS),this.eventBus.dispatch("resize",{source:this});const t=this._boundEvents;window.removeEventListener("mousemove",t.mouseMove),window.removeEventListener("mouseup",t.mouseUp)}_addEventListeners(){const e=this._boundEvents;e.mouseMove=this._mouseMove.bind(this),e.mouseUp=this._mouseUp.bind(this),this.resizer.addEventListener("mousedown",(t=>{0===t.button&&(this.outerContainer.classList.add(SIDEBAR_RESIZING_CLASS),window.addEventListener("mousemove",e.mouseMove),window.addEventListener("mouseup",e.mouseUp))})),this.eventBus._on("sidebarviewchanged",(e=>{this.sidebarOpen=!!e?.view})),this.eventBus._on("resize",(e=>{if(e?.source!==window)return;if(this._outerContainerWidth=null,!this._width)return;if(!this.sidebarOpen)return void this._updateWidth(this._width);this.outerContainer.classList.add(SIDEBAR_RESIZING_CLASS);const t=this._updateWidth(this._width);Promise.resolve().then((()=>{this.outerContainer.classList.remove(SIDEBAR_RESIZING_CLASS),t&&this.eventBus.dispatch("resize",{source:this})}))}))}}exports.PDFSidebarResizer=PDFSidebarResizer;