"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.XfaLayerBuilder=exports.DefaultXfaLayerFactory=void 0;var _pdf_link_service=require("./pdf_link_service.js"),_pdf=require("../pdf");class XfaLayerBuilder{constructor({pageDiv:e,pdfPage:i,annotationStorage:t,linkService:a,xfaHtml:r}){this.pageDiv=e,this.pdfPage=i,this.annotationStorage=t,this.linkService=a,this.xfaHtml=r,this.div=null,this._cancelled=!1}render(e,i="display"){if("print"===i){const t={viewport:e.clone({dontFlip:!0}),div:this.div,xfa:this.xfaHtml,page:null,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:i},a=document.createElement("div");this.pageDiv.appendChild(a),t.div=a;const r=_pdf.XfaLayer.render(t);return Promise.resolve(r)}return this.pdfPage.getXfa().then((t=>{if(this._cancelled||!t)return{textDivs:[]};const a={viewport:e.clone({dontFlip:!0}),div:this.div,xfa:t,page:this.pdfPage,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:i};return this.div?_pdf.XfaLayer.update(a):(this.div=document.createElement("div"),this.pageDiv.appendChild(this.div),a.div=this.div,_pdf.XfaLayer.render(a))})).catch((e=>{console.error(e)}))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}exports.XfaLayerBuilder=XfaLayerBuilder;class DefaultXfaLayerFactory{createXfaLayerBuilder(e,i,t=null,a=null){return new XfaLayerBuilder({pageDiv:e,pdfPage:i,annotationStorage:t,linkService:new _pdf_link_service.SimpleLinkService,xfaHtml:a})}}exports.DefaultXfaLayerFactory=DefaultXfaLayerFactory;