"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnnotationStorage=void 0;var _util=require("../shared/util.js");class AnnotationStorage{constructor(){this._storage=new Map,this._timeStamp=Date.now(),this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(t,e){const i=this._storage.get(t);return void 0===i?e:Object.assign(e,i)}setValue(t,e){const i=this._storage.get(t);let o=!1;if(void 0!==i)for(const[s,n]of Object.entries(e))i[s]!==n&&(o=!0,i[s]=n);else o=!0,this._storage.set(t,e);o&&(this._timeStamp=Date.now(),this._setModified())}getAll(){return this._storage.size>0?(0,_util.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,"function"===typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"===typeof this.onResetModified&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}get lastModified(){return this._timeStamp.toString()}}exports.AnnotationStorage=AnnotationStorage;