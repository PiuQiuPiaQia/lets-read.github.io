"use strict";var _util=require("../../shared/util.js"),_network=require("../../display/network.js");describe("network",(function(){const e=new URL("../pdfs/tracemonkey.pdf",window.location).href,t=1016315;it("read without stream and range",(async function(){const n=new _network.PDFNetworkStream({url:e,rangeChunkSize:65536,disableStream:!0,disableRange:!0}),a=n.getFullReader();let r,o;const u=a.headersReady.then((function(){r=a.isStreamingSupported,o=a.isRangeSupported}));let l=0,i=0;const c=function(){return a.read().then((function(e){if(!e.done)return i++,l+=e.value.byteLength,c()}))};await Promise.all([c(),u]),expect(l).toEqual(t),expect(i).toEqual(1),expect(r).toEqual(!1),expect(o).toEqual(!1)})),it("read custom ranges",(async function(){const n=32768,a=new _network.PDFNetworkStream({url:e,length:t,rangeChunkSize:n,disableStream:!0,disableRange:!1}),r=a.getFullReader();let o,u,l;const i=r.headersReady.then((function(){o=r.isStreamingSupported,u=r.isRangeSupported,r.cancel(new _util.AbortException("Don't need fullReader.")),l=!0})),c=t%n||n,d=a.getRangeReader(t-c-n,t-c),s=a.getRangeReader(t-c,t),p={value:0},g={value:0},w=function(e,t){return e.read().then((function(n){if(!n.done)return t.value+=n.value.byteLength,w(e,t)}))};await Promise.all([w(d,p),w(s,g),i]),expect(p.value).toEqual(n),expect(g.value).toEqual(c),expect(o).toEqual(!1),expect(u).toEqual(!0),expect(l).toEqual(!0)}))}));