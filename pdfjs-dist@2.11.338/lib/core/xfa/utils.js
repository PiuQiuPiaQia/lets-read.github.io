"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getBBox=getBBox,exports.getColor=getColor,exports.getFloat=getFloat,exports.getInteger=getInteger,exports.getKeyword=getKeyword,exports.getMeasurement=getMeasurement,exports.getRatio=getRatio,exports.getRelevant=getRelevant,exports.getStringOption=getStringOption,exports.stripQuotes=stripQuotes,exports.HTMLResult=void 0;var _util=require("../../shared/util.js");const dimConverters={pt:t=>t,cm:t=>t/2.54*72,mm:t=>t/25.4*72,in:t=>72*t,px:t=>t},measurementPattern=/([+-]?\d+\.?\d*)(.*)/;function stripQuotes(t){return t.startsWith("'")||t.startsWith('"')?t.slice(1,t.length-1):t}function getInteger({data:t,defaultValue:e,validate:r}){if(!t)return e;t=t.trim();const n=parseInt(t,10);return!isNaN(n)&&r(n)?n:e}function getFloat({data:t,defaultValue:e,validate:r}){if(!t)return e;t=t.trim();const n=parseFloat(t);return!isNaN(n)&&r(n)?n:e}function getKeyword({data:t,defaultValue:e,validate:r}){return t?(t=t.trim(),r(t)?t:e):e}function getStringOption(t,e){return getKeyword({data:t,defaultValue:e[0],validate:t=>e.includes(t)})}function getMeasurement(t,e="0"){if(e=e||"0",!t)return getMeasurement(e);const r=t.trim().match(measurementPattern);if(!r)return getMeasurement(e);const[,n,s]=r,i=parseFloat(n);if(isNaN(i))return getMeasurement(e);if(0===i)return 0;const u=dimConverters[s];return u?u(i):i}function getRatio(t){if(!t)return{num:1,den:1};const e=t.trim().split(/\s*:\s*/).map((t=>parseFloat(t))).filter((t=>!isNaN(t)));if(1===e.length&&e.push(1),0===e.length)return{num:1,den:1};const[r,n]=e;return{num:r,den:n}}function getRelevant(t){return t?t.trim().split(/\s+/).map((t=>({excluded:"-"===t[0],viewname:t.substring(1)}))):[]}function getColor(t,e=[0,0,0]){let[r,n,s]=e;if(!t)return{r:r,g:n,b:s};const i=t.trim().split(/\s*,\s*/).map((t=>Math.min(Math.max(0,parseInt(t.trim(),10)),255))).map((t=>isNaN(t)?0:t));return i.length<3||([r,n,s]=i),{r:r,g:n,b:s}}function getBBox(t){const e=-1;if(!t)return{x:e,y:e,width:e,height:e};const r=t.trim().split(/\s*,\s*/).map((t=>getMeasurement(t,"-1")));if(r.length<4||r[2]<0||r[3]<0)return{x:e,y:e,width:e,height:e};const[n,s,i,u]=r;return{x:n,y:s,width:i,height:u}}class HTMLResult{static get FAILURE(){return(0,_util.shadow)(this,"FAILURE",new HTMLResult(!1,null,null,null))}static get EMPTY(){return(0,_util.shadow)(this,"EMPTY",new HTMLResult(!0,null,null,null))}constructor(t,e,r,n){this.success=t,this.html=e,this.bbox=r,this.breakNode=n}isBreak(){return!!this.breakNode}static breakNode(t){return new HTMLResult(!1,null,null,t)}static success(t,e=null){return new HTMLResult(!0,t,e,null)}}exports.HTMLResult=HTMLResult;