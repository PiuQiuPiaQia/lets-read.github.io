"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Jbig2Stream=void 0;var _primitives=require("./primitives.js"),_decode_stream=require("./decode_stream.js"),_jbig=require("./jbig2.js"),_util=require("../shared/util.js");class Jbig2Stream extends _decode_stream.DecodeStream{constructor(e,t,s){super(t),this.stream=e,this.dict=e.dict,this.maybeLength=t,this.params=s}get bytes(){return(0,_util.shadow)(this,"bytes",this.stream.getBytes(this.maybeLength))}ensureBuffer(e){}readBlock(){if(this.eof)return;const e=new _jbig.Jbig2Image,t=[];if((0,_primitives.isDict)(this.params)){const e=this.params.get("JBIG2Globals");if((0,_primitives.isStream)(e)){const s=e.getBytes();t.push({data:s,start:0,end:s.length})}}t.push({data:this.bytes,start:0,end:this.bytes.length});const s=e.parseChunks(t),i=s.length;for(let r=0;r<i;r++)s[r]^=255;this.buffer=s,this.bufferLength=i,this.eof=!0}}exports.Jbig2Stream=Jbig2Stream;